"use strict";!function(){function o(e){var t=e.find(".colors__item"),e=e.find(".colors__content");t.removeClass("active"),e.width(0)}function i(e){var t,n,o,i,a,r,l=e.find(".colors__content"),s=(t=e,n=0,c=$(window).width(),o=t.closest(".colors__menu").find(".colors__button"),s=o.width()*o.length,t=t.find(".colors__container"),i=parseInt(t.css("padding-left")),t=parseInt(t.css("padding-right")),a=window.matchMedia("(max-width: 768px)").matches,r=window.matchMedia("(max-width: 480px)").matches,a&&(n=c-s),r&&(n=c-o.width()),{container:n=a||r?n:524,textContainer:n-t-i}),c=e.find(".colors__container");e.addClass("active"),l.width(s.container),c.width(s.textContainer)}$(".colors__button").on("click",function(e){e.preventDefault();var e=$(e.currentTarget),t=e.closest(".colors__item"),n=t.hasClass("active"),e=e.closest(".colors__menu");n?o(e):(o(e),i(t))}),$(".colors__close").on("click",function(e){e.preventDefault(),o($(".colors__menu"))})}();var myMap,init=function(){myMap=new ymaps.Map("map",{center:[52.029222,47.830666],zoom:12,controls:[]});var t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/svg/marker.svg",iconImageSize:[30,42],iconImageOffset:[-3,-42]});[[52.010892,47.809866],[52.028943,47.831588],[52.01307,47.823206],[52.028342,47.781668]].forEach(function(e){t.add(new ymaps.Placemark(e))}),myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom"),myMap.controls.add("zoomControl",{float:"none",position:{right:40,top:5}})},hamburger=(ymaps.ready(init),document.querySelector(".hamburger")),menu=document.querySelector(".menu"),body=document.querySelector("body"),links=document.querySelectorAll(".menu__link");function toggleMenu(){hamburger.classList.toggle("hamburger--active"),menu.classList.toggle("menu--active"),body.classList.toggle("body--active-menu")}links.forEach(function(e){e.addEventListener("click",toggleMenu)}),hamburger.addEventListener("click",toggleMenu);var video,durationControl,soundControl,soundLevel,intervalId,validateFields=function(e,t){return t.forEach(function(e){e.removeClass("input-error"),""===e.val().trim()&&e.addClass("input-error")}),0===e.find(".input-error").length},findBlockByAlias=($(".form").submit(function(e){e.preventDefault();var e=$(e.currentTarget),t=e.find("[name='name']"),n=e.find("[name='phone']"),o=e.find("[name='comment']"),i=e.find("[name='to']"),a=$("#modal"),r=a.find(".modal__content");a.removeClass("error-modal"),validateFields(e,[t,n,o,i])&&((e=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:t.val(),phone:n.val(),comment:o.val(),to:i.val()}})).done(function(e){r.text(e.message)}),e.fail(function(e){e=null!=(e=null==e||null==(e=e.responseJSON)?void 0:e.message)?e:"Произошла ошибка, попробуйте позже";r.text(e),a.addClass("error-modal")}),e.always(function(){$.fancybox.open({src:"#modal",type:"inline"})}))}),$(".app-submit-btn").click(function(e){e.preventDefault(),$.fancybox.close()}),function(n){return $(".reviews__item").filter(function(e,t){return $(t).attr("data-linked-with")===n})}),sections=($(".reviews-switcher__link").click(function(e){e.preventDefault();var e=$(e.currentTarget),t=e.attr("data-open"),t=findBlockByAlias(t),e=e.closest(".reviews-switcher__item");t.addClass("active").siblings().removeClass("active"),e.addClass("active").siblings().removeClass("active")}),$("section")),display=$(".wrapper__content"),sideMenu=$(".fixed-menu"),menuItems=sideMenu.find(".fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile(),inScroll=!1,countSectionPosition=(sections.first().addClass("active"),function(e){e*=-100;return isNaN(e)?(console.error("передано неверное значение в  countSectionPosition"),0):e}),changeMenuThemeForSection=function(e){var t="fixed-menu--shadowed";"white"===sections.eq(e).attr("data-sidemenu-theme")?sideMenu.addClass(t):sideMenu.removeClass(t)},resetActiveClassForItem=function(e,t,n){e.eq(t).addClass(n).siblings().removeClass(n)},performTransition=function(e){var t;inScroll||(inScroll=!0,t=countSectionPosition(e),changeMenuThemeForSection(e),display.css({transform:"translateY(".concat(t,"%)")}),resetActiveClassForItem(sections,e,"active"),setTimeout(function(){inScroll=!1,resetActiveClassForItem(menuItems,e,"fixed-menu__item--active")},1300))},viewportScroller=function(){var e=sections.filter(".active"),t=e.next(),n=e.prev();return{next:function(){t.length&&performTransition(t.index())},prev:function(){n.length&&performTransition(n.index())}}},slider=($(window).on("wheel",function(e){var e=e.originalEvent.deltaY,t=viewportScroller();0<e&&t.next(),e<0&&t.prev()}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase(),t="input"===t||"textarea"===t,n=viewportScroller();if(!t)switch(e.code){case 38:n.prev();break;case 40:n.next()}}),$(".wrapper").on("touchmove",function(e){return e.preventDefault()}),$("[data-scroll-to]").click(function(e){e.preventDefault();e=$(e.currentTarget).attr("data-scroll-to"),e=$("[data-section-id=".concat(e,"]"));performTransition(e.index())}),isMobile&&$("body").swipe({swipe:function(e,t){var n=viewportScroller(),t="down"===t?"prev":"up"===t?"next":"";t&&n[t]()}}),$(".slider__list").bxSlider({pager:!1,controls:!1})),openItem=($(".slider__arrow--left").click(function(e){e.preventDefault(),slider.goToPrevSlide()}),$(".slider__arrow--right").click(function(e){e.preventDefault(),slider.goToNextSlide()}),function(e){var e=e.closest(".team__item"),t=e.find(".team__content"),n=t.find(".team__content-block").height(),o=e.find(".team__dropdown-icon");e.addClass("active"),t.height(n),o.addClass("active")}),closeEveryItem=function(e){var t=e.find(".team__content"),n=e.find(".team__item"),e=e.find(".team__dropdown-icon");n.removeClass("active"),e.removeClass("active"),t.height(0)};function playStop(){document.querySelector(".video__play").classList.toggle("video__play--active"),durationControl.max=video.duration,video.paused?(video.play(),intervalId=setInterval(updateDuration,1e3/66)):(video.pause(),clearInterval(intervalId))}function updateDuration(){durationControl.value=video.currentTime}function stopInterval(){video.pause(),clearInterval(intervalId)}function setVideoDuration(){video.paused?video.play():video.pause(),video.currentTime=durationControl.value,intervalId=setInterval(updateDuration,1e3/66)}function changeSoundVolume(){video.volume=soundControl.value/10}function soundOf(){0===video.volume?(video.volume=soundLevel,soundControl.value=10*soundLevel):(soundLevel=video.volume,video.volume=0,soundControl.value=0)}$(".team__dropdown").click(function(e){var e=$(e.currentTarget),t=e.closest(".team");e.closest(".team__item").hasClass("active")?closeEveryItem(t):(closeEveryItem(t),openItem(e))}),document.addEventListener("DOMContentLoaded",function(e){(video=document.getElementById("video")).addEventListener("click",playStop);for(var t=document.querySelectorAll(".play"),n=0;n<t.length;n++)t[n].addEventListener("click",playStop);document.getElementById("micLevel").addEventListener("click",soundOf),(durationControl=document.getElementById("durationLevel")).addEventListener("mousedown",stopInterval),durationControl.addEventListener("click",setVideoDuration),durationControl.min=0,durationControl.value=0,(soundControl=document.getElementById("volumeLevel")).addEventListener("click",changeSoundVolume),soundControl.addEventListener("mouseup",changeSoundVolume),soundControl.min=0,soundControl.max=10,soundControl.value=soundControl.max});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhvcml6b250YWwtYWNjby5qcyIsIm1hcC5qcyIsIm1lbnUuanMiLCJtb2RhbC5qcyIsInZpZGVvLmpzIiwicmV2aWV3cy5qcyIsInNjcm9sbC5qcyIsInNsaWRlci5qcyIsInRlYW0uanMiXSwibmFtZXMiOlsiY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lciIsImNvbnRhaW5lciIsIml0ZW1zIiwiZmluZCIsImNvbnRlbnQiLCJyZW1vdmVDbGFzcyIsIndpZHRoIiwib3Blbkl0ZW0iLCJpdGVtIiwicmVxSXRlbVdpZHRoIiwidGl0bGVzQmxvY2tzIiwicGFkZGluZ0xlZnQiLCJpc1RhYmxldCIsImlzTW9iaWxlIiwiaGlkZGVuQ29udGVudCIsInJlcVdpZHRoIiwic2NyZWVuV2lkdGgiLCIkIiwid2luZG93IiwiY2xvc2VzdCIsInRpdGxlV2lkdGgiLCJsZW5ndGgiLCJ0ZXh0Q29udGFpbmVyIiwicGFyc2VJbnQiLCJjc3MiLCJwYWRkaW5nUmlnaHQiLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsInRleHRCbG9jayIsImFkZENsYXNzIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCIkdGhpcyIsImN1cnJlbnRUYXJnZXQiLCJpdGVtT3BlbmVkIiwiaGFzQ2xhc3MiLCJteU1hcCIsImluaXQiLCJ5bWFwcyIsIk1hcCIsImNlbnRlciIsInpvb20iLCJjb250cm9scyIsIm15Q29sbGVjdGlvbiIsIkdlb09iamVjdENvbGxlY3Rpb24iLCJkcmFnZ2FibGUiLCJpY29uTGF5b3V0IiwiaWNvbkltYWdlSHJlZiIsImljb25JbWFnZVNpemUiLCJpY29uSW1hZ2VPZmZzZXQiLCJmb3JFYWNoIiwiY29vcmQiLCJhZGQiLCJQbGFjZW1hcmsiLCJnZW9PYmplY3RzIiwiYmVoYXZpb3JzIiwiZGlzYWJsZSIsImZsb2F0IiwicG9zaXRpb24iLCJyaWdodCIsInRvcCIsImhhbWJ1cmdlciIsInJlYWR5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibWVudSIsImJvZHkiLCJsaW5rcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ0b2dnbGVNZW51IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiZWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJ2aWRlbyIsImR1cmF0aW9uQ29udHJvbCIsInNvdW5kQ29udHJvbCIsInNvdW5kTGV2ZWwiLCJpbnRlcnZhbElkIiwidmFsaWRhdGVGaWVsZHMiLCJmb3JtIiwiZmllbGRzQXJyYXkiLCJmaWVsZCIsInZhbCIsInRyaW0iLCJmaW5kQmxvY2tCeUFsaWFzIiwic3VibWl0IiwibmFtZSIsInBob25lIiwiY29tbWVudCIsInRvIiwibW9kYWwiLCJyZXF1ZXN0IiwiYWpheCIsInVybCIsIm1ldGhvZCIsImRhdGEiLCJkb25lIiwidGV4dCIsIm1lc3NhZ2UiLCJmYWlsIiwiX2RhdGEkcmVzcG9uc2VKU09OJG1lIiwiX2RhdGEkcmVzcG9uc2VKU09OIiwicmVzcG9uc2VKU09OIiwiYWx3YXlzIiwiZmFuY3lib3giLCJvcGVuIiwic3JjIiwidHlwZSIsImNsaWNrIiwiY2xvc2UiLCJhbGlhcyIsImZpbHRlciIsIm5keCIsImF0dHIiLCJzZWN0aW9ucyIsInRhcmdldCIsIml0ZW1Ub1Nob3ciLCJjdXJJdGVtIiwic2libGluZ3MiLCJkaXNwbGF5Iiwic2lkZU1lbnUiLCJtZW51SXRlbXMiLCJtb2JpbGVEZXRlY3QiLCJNb2JpbGVEZXRlY3QiLCJuYXZpZ2F0b3IiLCJ1c2VyQWdlbnQiLCJtb2JpbGUiLCJpblNjcm9sbCIsImNvdW50U2VjdGlvblBvc2l0aW9uIiwiZmlyc3QiLCJzZWN0aW9uRXEiLCJpc05hTiIsImNvbnNvbGUiLCJlcnJvciIsImNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24iLCJhY3RpdmVDbGFzcyIsImVxIiwicmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0iLCJpdGVtRXEiLCJwZXJmb3JtVHJhbnNpdGlvbiIsInRyYW5zZm9ybSIsImNvbmNhdCIsInNldFRpbWVvdXQiLCJ0cmFuc2l0aW9uT3ZlciIsInZpZXdwb3J0U2Nyb2xsZXIiLCJhY3RpdmVTZWN0aW9uIiwibmV4dFNlY3Rpb24iLCJuZXh0IiwicHJldlNlY3Rpb24iLCJwcmV2IiwiaW5kZXgiLCJzbGlkZXIiLCJkZWx0YVkiLCJvcmlnaW5hbEV2ZW50Iiwic2Nyb2xsZXIiLCJ0YWdOYW1lIiwidG9Mb3dlckNhc2UiLCJ1c2VyVHlwaW5nSW5JbnB1dHMiLCJjb2RlIiwicmVxU2VjdGlvbiIsInN3aXBlIiwiZXZlbnQiLCJkaXJlY3Rpb24iLCJzY3JvbGxEaXJlY3Rpb24iLCJieFNsaWRlciIsInBhZ2VyIiwiZ29Ub1ByZXZTbGlkZSIsImdvVG9OZXh0U2xpZGUiLCJjb250ZW50QmxvY2siLCJyZXFIZWlnaHQiLCJoZWlnaHQiLCJyZWN0YW5nbGVQb3NpdGlvbiIsImNsb3NlRXZlcnlJdGVtIiwiaXRlbUNvbnRhaW5lciIsIml0ZW1SZWN0YW5nbGUiLCJwbGF5U3RvcCIsIm1heCIsImR1cmF0aW9uIiwicGF1c2VkIiwicGxheSIsInNldEludGVydmFsIiwidXBkYXRlRHVyYXRpb24iLCJwYXVzZSIsImNsZWFySW50ZXJ2YWwiLCJ2YWx1ZSIsImN1cnJlbnRUaW1lIiwic3RvcEludGVydmFsIiwic2V0VmlkZW9EdXJhdGlvbiIsImNoYW5nZVNvdW5kVm9sdW1lIiwidm9sdW1lIiwic291bmRPZiIsImdldEVsZW1lbnRCeUlkIiwicGxheUJ1dHRvbnMiLCJpIiwibWluIl0sIm1hcHBpbmdzIjoiYUFBQSxDQUFBLFdBOEJBLFNBQUFBLEVBQUFDLEdBQ0EsSUFBQUMsRUFBQUQsRUFBQUUsS0FBQSxlQUFBLEVBQ0FDLEVBQUFILEVBQUFFLEtBQUEsa0JBQUEsRUFFQUQsRUFBQUcsWUFBQSxRQUFBLEVBQ0FELEVBQUFFLE1BQUEsQ0FBQSxDQUNBLENBRUEsU0FBQUMsRUFBQUMsR0FDQSxJQXRDQUEsRUFDQUMsRUFJQUMsRUFJQUMsRUFHQUMsRUFDQUMsRUF5QkFDLEVBQUFOLEVBQUFMLEtBQUEsa0JBQUEsRUFDQVksR0F2Q0FQLEVBdUNBQSxFQXRDQUMsRUFBQSxFQUVBTyxFQUFBQyxFQUFBQyxNQUFBLEVBQUFaLE1BQUEsRUFFQUksRUFEQUYsRUFBQVcsUUFBQSxlQUFBLEVBQ0FoQixLQUFBLGlCQUFBLEVBQ0FpQixFQUFBVixFQUFBSixNQUFBLEVBQUFJLEVBQUFXLE9BRUFDLEVBQUFkLEVBQUFMLEtBQUEsb0JBQUEsRUFDQVEsRUFBQVksU0FBQUQsRUFBQUUsSUFBQSxjQUFBLENBQUEsRUFDQUMsRUFBQUYsU0FBQUQsRUFBQUUsSUFBQSxlQUFBLENBQUEsRUFFQVosRUFBQU0sT0FBQVEsV0FBQSxvQkFBQSxFQUFBQyxRQUNBZCxFQUFBSyxPQUFBUSxXQUFBLG9CQUFBLEVBQUFDLFFBRUFmLElBQ0FILEVBQUFPLEVBQUFJLEdBQ0FQLElBQ0FKLEVBQUFPLEVBQUFOLEVBQUFKLE1BQUEsR0FLQSxDQUNBTCxVQUpBUSxFQURBRyxHQUFBQyxFQUtBSixFQUpBLElBS0FhLGNBQUFiLEVBQUFnQixFQUFBZCxDQUNBLEdBY0FpQixFQUFBcEIsRUFBQUwsS0FBQSxvQkFBQSxFQUVBSyxFQUFBcUIsU0FBQSxRQUFBLEVBQ0FmLEVBQUFSLE1BQUFTLEVBQUFkLFNBQUEsRUFDQTJCLEVBQUF0QixNQUFBUyxFQUFBTyxhQUFBLENBQ0EsQ0FFQUwsRUFBQSxpQkFBQSxFQUFBYSxHQUFBLFFBQUEsU0FBQUMsR0FDQUEsRUFBQUMsZUFBQSxFQUVBLElBQUFDLEVBQUFoQixFQUFBYyxFQUFBRyxhQUFBLEVBQ0ExQixFQUFBeUIsRUFBQWQsUUFBQSxlQUFBLEVBQ0FnQixFQUFBM0IsRUFBQTRCLFNBQUEsUUFBQSxFQUNBbkMsRUFBQWdDLEVBQUFkLFFBQUEsZUFBQSxFQUVBZ0IsRUFDQW5DLEVBQUFDLENBQUEsR0FFQUQsRUFBQUMsQ0FBQSxFQUNBTSxFQUFBQyxDQUFBLEVBRUEsQ0FBQSxFQUVBUyxFQUFBLGdCQUFBLEVBQUFhLEdBQUEsUUFBQSxTQUFBQyxHQUNBQSxFQUFBQyxlQUFBLEVBRUFoQyxFQUFBaUIsRUFBQSxlQUFBLENBQUEsQ0FDQSxDQUFBLENBQ0EsRUFBQSxFQ3JFQSxJQUFBb0IsTUFFQUMsS0FBQSxXQUNBRCxNQUFBLElBQUFFLE1BQUFDLElBQUEsTUFBQSxDQUNBQyxPQUFBLENBQUEsVUFBQSxXQUNBQyxLQUFBLEdBQ0FDLFNBQUEsRUFDQSxDQUFBLEVBRUEsSUFPQUMsRUFBQSxJQUFBTCxNQUFBTSxvQkFBQSxHQUFBLENBQ0FDLFVBQUEsQ0FBQSxFQUNBQyxXQUFBLGdCQUNBQyxjQUFBLHVCQUNBQyxjQUFBLENBQUEsR0FBQSxJQUNBQyxnQkFBQSxDQUFBLENBQUEsRUFBQSxDQUFBLEdBQ0EsQ0FBQSxFQWJBLENBQ0EsQ0FBQSxVQUFBLFdBQ0EsQ0FBQSxVQUFBLFdBQ0EsQ0FBQSxTQUFBLFdBQ0EsQ0FBQSxVQUFBLFlBV0FDLFFBQUEsU0FBQUMsR0FDQVIsRUFBQVMsSUFBQSxJQUFBZCxNQUFBZSxVQUFBRixDQUFBLENBQUEsQ0FDQSxDQUFBLEVBRUFmLE1BQUFrQixXQUFBRixJQUFBVCxDQUFBLEVBRUFQLE1BQUFtQixVQUFBQyxRQUFBLFlBQUEsRUFFQXBCLE1BQUFNLFNBQUFVLElBQUEsY0FBQSxDQUNBSyxNQUFBLE9BQ0FDLFNBQUEsQ0FDQUMsTUFBQSxHQUNBQyxJQUFBLENBQ0EsQ0FDQSxDQUFBLENBQ0EsRUN2Q0FDLFdEeUNBdkIsTUFBQXdCLE1BQUF6QixJQUFBLEVDekNBMEIsU0FBQUMsY0FBQSxZQUFBLEdBQ0FDLEtBQUFGLFNBQUFDLGNBQUEsT0FBQSxFQUNBRSxLQUFBSCxTQUFBQyxjQUFBLE1BQUEsRUFFQUcsTUFBQUosU0FBQUssaUJBQUEsYUFBQSxFQU1BLFNBQUFDLGFBQ0FSLFVBQUFTLFVBQUFDLE9BQUEsbUJBQUEsRUFDQU4sS0FBQUssVUFBQUMsT0FBQSxjQUFBLEVBQ0FMLEtBQUFJLFVBQUFDLE9BQUEsbUJBQUEsQ0FDQSxDQVJBSixNQUFBakIsUUFBQSxTQUFBc0IsR0FDQUEsRUFBQUMsaUJBQUEsUUFBQUosVUFBQSxDQUNBLENBQUEsRUFRQVIsVUFBQVksaUJBQUEsUUFBQUosVUFBQSxFQ2hCQSxJQ0FBSyxNQUNBQyxnQkFDQUMsYUFDQUMsV0FDQUMsV0RKQUMsZUFBQSxTQUFBQyxFQUFBQyxHQVdBLE9BVEFBLEVBQUEvQixRQUFBLFNBQUFnQyxHQUNBQSxFQUFBOUUsWUFBQSxhQUFBLEVBQ0EsS0FBQThFLEVBQUFDLElBQUEsRUFBQUMsS0FBQSxHQUNBRixFQUFBdEQsU0FBQSxhQUFBLENBRUEsQ0FBQSxFQUlBLElBRkFvRCxFQUFBOUUsS0FBQSxjQUFBLEVBRUFrQixNQUNBLEVFWkFpRSxrQkZjQXJFLEVBQUEsT0FBQSxFQUFBc0UsT0FBQSxTQUFBeEQsR0FDQUEsRUFBQUMsZUFBQSxFQUVBLElBQUFpRCxFQUFBaEUsRUFBQWMsRUFBQUcsYUFBQSxFQUNBc0QsRUFBQVAsRUFBQTlFLEtBQUEsZUFBQSxFQUNBc0YsRUFBQVIsRUFBQTlFLEtBQUEsZ0JBQUEsRUFDQXVGLEVBQUFULEVBQUE5RSxLQUFBLGtCQUFBLEVBQ0F3RixFQUFBVixFQUFBOUUsS0FBQSxhQUFBLEVBRUF5RixFQUFBM0UsRUFBQSxRQUFBLEVBQ0FiLEVBQUF3RixFQUFBekYsS0FBQSxpQkFBQSxFQUVBeUYsRUFBQXZGLFlBQUEsYUFBQSxFQUVBMkUsZUFBQUMsRUFBQSxDQUFBTyxFQUFBQyxFQUFBQyxFQUFBQyxFQUFBLEtBR0FFLEVBQUE1RSxFQUFBNkUsS0FBQSxDQUNBQyxJQUFBLDZDQUNBQyxPQUFBLE9BQ0FDLEtBQUEsQ0FDQVQsS0FBQUEsRUFBQUosSUFBQSxFQUNBSyxNQUFBQSxFQUFBTCxJQUFBLEVBQ0FNLFFBQUFBLEVBQUFOLElBQUEsRUFDQU8sR0FBQUEsRUFBQVAsSUFBQSxDQUNBLENBQ0EsQ0FBQSxHQUVBYyxLQUFBLFNBQUFELEdBQ0E3RixFQUFBK0YsS0FBQUYsRUFBQUcsT0FBQSxDQUNBLENBQUEsRUFFQVAsRUFBQVEsS0FBQSxTQUFBSixHQUNBRyxFQUFBLE9BQUFFLEVBQUFMLE1BQUFBLEdBQUEsT0FBQU0sRUFBQU4sRUFBQU8sY0FBQSxLQUFBLEVBQUFELEVBQUFILFNBQUFFLEVBQUEscUNBQ0FsRyxFQUFBK0YsS0FBQUMsQ0FBQSxFQUNBUixFQUFBL0QsU0FBQSxhQUFBLENBQ0EsQ0FBQSxFQUVBZ0UsRUFBQVksT0FBQSxXQUNBeEYsRUFBQXlGLFNBQUFDLEtBQUEsQ0FDQUMsSUFBQSxTQUNBQyxLQUFBLFFBQ0EsQ0FBQSxDQUNBLENBQUEsRUFFQSxDQUFBLEVBR0E1RixFQUFBLGlCQUFBLEVBQUE2RixNQUFBLFNBQUEvRSxHQUNBQSxFQUFBQyxlQUFBLEVBRUFmLEVBQUF5RixTQUFBSyxNQUFBLENBQ0EsQ0FBQSxFRWxFQSxTQUFBQyxHQUNBLE9BQUEvRixFQUFBLGdCQUFBLEVBQUFnRyxPQUFBLFNBQUFDLEVBQUExRyxHQUNBLE9BQUFTLEVBQUFULENBQUEsRUFBQTJHLEtBQUEsa0JBQUEsSUFBQUgsQ0FDQSxDQUFBLENBQ0EsR0NKQUksVURNQW5HLEVBQUEseUJBQUEsRUFBQTZGLE1BQUEsU0FBQS9FLEdBQ0FBLEVBQUFDLGVBQUEsRUFFQSxJQUFBQyxFQUFBaEIsRUFBQWMsRUFBQUcsYUFBQSxFQUNBbUYsRUFBQXBGLEVBQUFrRixLQUFBLFdBQUEsRUFDQUcsRUFBQWhDLGlCQUFBK0IsQ0FBQSxFQUNBRSxFQUFBdEYsRUFBQWQsUUFBQSx5QkFBQSxFQUVBbUcsRUFBQXpGLFNBQUEsUUFBQSxFQUFBMkYsU0FBQSxFQUFBbkgsWUFBQSxRQUFBLEVBQ0FrSCxFQUFBMUYsU0FBQSxRQUFBLEVBQUEyRixTQUFBLEVBQUFuSCxZQUFBLFFBQUEsQ0FDQSxDQUFBLEVDaEJBWSxFQUFBLFNBQUEsR0FDQXdHLFFBQUF4RyxFQUFBLG1CQUFBLEVBQ0F5RyxTQUFBekcsRUFBQSxhQUFBLEVBQ0EwRyxVQUFBRCxTQUFBdkgsS0FBQSxtQkFBQSxFQUVBeUgsYUFBQSxJQUFBQyxhQUFBM0csT0FBQTRHLFVBQUFDLFNBQUEsRUFDQWxILFNBQUErRyxhQUFBSSxPQUFBLEVBRUFDLFNBQUEsQ0FBQSxFQUlBQyxzQkFGQWQsU0FBQWUsTUFBQSxFQUFBdEcsU0FBQSxRQUFBLEVBRUEsU0FBQXVHLEdBQ0F6RSxHQUFBLENBQUEsSUFFQSxPQUFBMEUsTUFBQTFFLENBQUEsR0FDQTJFLFFBQUFDLE1BQUEsb0RBQUEsRUFDQSxHQUdBNUUsQ0FDQSxHQUVBNkUsMEJBQUEsU0FBQUosR0FDQSxJQUVBSyxFQUFBLHVCQUVBLFVBSkFyQixTQUFBc0IsR0FBQU4sQ0FBQSxFQUNBakIsS0FBQSxxQkFBQSxFQUlBTyxTQUFBN0YsU0FBQTRHLENBQUEsRUFFQWYsU0FBQXJILFlBQUFvSSxDQUFBLENBRUEsRUFFQUUsd0JBQUEsU0FBQXpJLEVBQUEwSSxFQUFBSCxHQUNBdkksRUFBQXdJLEdBQUFFLENBQUEsRUFBQS9HLFNBQUE0RyxDQUFBLEVBQUFqQixTQUFBLEVBQUFuSCxZQUFBb0ksQ0FBQSxDQUNBLEVBRUFJLGtCQUFBLFNBQUFULEdBQ0EsSUFPQXpFLEVBUEFzRSxXQUtBQSxTQUFBLENBQUEsRUFFQXRFLEVBQUF1RSxxQkFBQUUsQ0FBQSxFQUVBSSwwQkFBQUosQ0FBQSxFQUVBWCxRQUFBakcsSUFBQSxDQUNBc0gsVUFBQSxjQUFBQyxPQUFBcEYsRUFBQSxJQUFBLENBQ0EsQ0FBQSxFQUVBZ0Ysd0JBQUF2QixTQUFBZ0IsRUFBQSxRQUFBLEVBTUFZLFdBQUEsV0FDQWYsU0FBQSxDQUFBLEVBQ0FVLHdCQUFBaEIsVUFBQVMsRUFBQSwwQkFBQSxDQUNBLEVBQUFhLElBQUEsRUFFQSxFQUVBQyxpQkFBQSxXQUNBLElBQUFDLEVBQUEvQixTQUFBSCxPQUFBLFNBQUEsRUFDQW1DLEVBQUFELEVBQUFFLEtBQUEsRUFDQUMsRUFBQUgsRUFBQUksS0FBQSxFQUdBLE1BQUEsQ0FDQUYsS0FBQSxXQUNBRCxFQUFBL0gsUUFDQXdILGtCQUFBTyxFQUFBSSxNQUFBLENBQUEsQ0FFQSxFQUNBRCxLQUFBLFdBQ0FELEVBQUFqSSxRQUNBd0gsa0JBQUFTLEVBQUFFLE1BQUEsQ0FBQSxDQUVBLENBQ0EsQ0FDQSxFQ3RGQUMsUUR3RkF4SSxFQUFBQyxNQUFBLEVBQUFZLEdBQUEsUUFBQSxTQUFBQyxHQUNBLElBQUEySCxFQUFBM0gsRUFBQTRILGNBQUFELE9BQ0FFLEVBQUFWLGlCQUFBLEVBRUEsRUFBQVEsR0FDQUUsRUFBQVAsS0FBQSxFQUdBSyxFQUFBLEdBQ0FFLEVBQUFMLEtBQUEsQ0FFQSxDQUFBLEVBRUF0SSxFQUFBQyxNQUFBLEVBQUFZLEdBQUEsVUFBQSxTQUFBQyxHQUNBLElBQUE4SCxFQUFBOUgsRUFBQXNGLE9BQUF3QyxRQUFBQyxZQUFBLEVBQ0FDLEVBQUEsVUFBQUYsR0FBQSxhQUFBQSxFQUNBRCxFQUFBVixpQkFBQSxFQUVBLEdBQUFhLENBQUFBLEVBQ0EsT0FBQWhJLEVBQUFpSSxNQUNBLEtBQUEsR0FDQUosRUFBQUwsS0FBQSxFQUNBLE1BRUEsS0FBQSxHQUNBSyxFQUFBUCxLQUFBLENBQ0EsQ0FFQSxDQUFBLEVBRUFwSSxFQUFBLFVBQUEsRUFBQWEsR0FBQSxZQUFBLFNBQUFDLEdBQUEsT0FBQUEsRUFBQUMsZUFBQSxDQUFBLENBQUEsRUFFQWYsRUFBQSxrQkFBQSxFQUFBNkYsTUFBQSxTQUFBL0UsR0FDQUEsRUFBQUMsZUFBQSxFQUdBcUYsRUFEQXBHLEVBQUFjLEVBQUFHLGFBQUEsRUFDQWlGLEtBQUEsZ0JBQUEsRUFDQThDLEVBQUFoSixFQUFBLG9CQUFBOEgsT0FBQTFCLEVBQUEsR0FBQSxDQUFBLEVBRUF3QixrQkFBQW9CLEVBQUFULE1BQUEsQ0FBQSxDQUNBLENBQUEsRUFFQTNJLFVBRUFJLEVBQUEsTUFBQSxFQUFBaUosTUFBQSxDQUNBQSxNQUFBLFNBQUFDLEVBQUFDLEdBQ0EsSUFBQVIsRUFBQVYsaUJBQUEsRUFDQW1CLEVBR0EsU0FBQUQsRUFBQSxPQURBLE9BQUFBLEVBQUEsT0FGQSxHQUlBQyxHQUNBVCxFQUFBUyxHQUFBLENBQ0EsQ0FDQSxDQUFBLEVDOUlBcEosRUFBQSxlQUFBLEVBQUFxSixTQUFBLENBQ0FDLE1BQUEsQ0FBQSxFQUNBNUgsU0FBQSxDQUFBLENBQ0EsQ0FBQSxHQ0hBcEMsVURLQVUsRUFBQSxzQkFBQSxFQUFBNkYsTUFBQSxTQUFBL0UsR0FDQUEsRUFBQUMsZUFBQSxFQUNBeUgsT0FBQWUsY0FBQSxDQUNBLENBQUEsRUFFQXZKLEVBQUEsdUJBQUEsRUFBQTZGLE1BQUEsU0FBQS9FLEdBQ0FBLEVBQUFDLGVBQUEsRUFDQXlILE9BQUFnQixjQUFBLENBQ0EsQ0FBQSxFQ2JBLFNBQUFqSyxHQUNBLElBQUFQLEVBQUFPLEVBQUFXLFFBQUEsYUFBQSxFQUNBdUosRUFBQXpLLEVBQUFFLEtBQUEsZ0JBQUEsRUFFQXdLLEVBREFELEVBQUF2SyxLQUFBLHNCQUFBLEVBQ0F5SyxPQUFBLEVBQ0FDLEVBQUE1SyxFQUFBRSxLQUFBLHNCQUFBLEVBRUFGLEVBQUE0QixTQUFBLFFBQUEsRUFDQTZJLEVBQUFFLE9BQUFELENBQUEsRUFDQUUsRUFBQWhKLFNBQUEsUUFBQSxDQUNBLEdBRUFpSixlQUFBLFNBQUE3SyxHQUNBLElBQUFDLEVBQUFELEVBQUFFLEtBQUEsZ0JBQUEsRUFDQTRLLEVBQUE5SyxFQUFBRSxLQUFBLGFBQUEsRUFDQTZLLEVBQUEvSyxFQUFBRSxLQUFBLHNCQUFBLEVBRUE0SyxFQUFBMUssWUFBQSxRQUFBLEVBQ0EySyxFQUFBM0ssWUFBQSxRQUFBLEVBQ0FILEVBQUEwSyxPQUFBLENBQUEsQ0FDQSxFSmlCQSxTQUFBSyxXQUNBakgsU0FBQUMsY0FBQSxjQUFBLEVBQ0FNLFVBQUFDLE9BQUEscUJBQUEsRUFFQUksZ0JBQUFzRyxJQUFBdkcsTUFBQXdHLFNBRUF4RyxNQUFBeUcsUUFDQXpHLE1BQUEwRyxLQUFBLEVBQ0F0RyxXQUFBdUcsWUFBQUMsZUFBQSxJQUFBLEVBQUEsSUFFQTVHLE1BQUE2RyxNQUFBLEVBQ0FDLGNBQUExRyxVQUFBLEVBRUEsQ0FFQSxTQUFBd0csaUJBQ0EzRyxnQkFBQThHLE1BQUEvRyxNQUFBZ0gsV0FDQSxDQUVBLFNBQUFDLGVBQ0FqSCxNQUFBNkcsTUFBQSxFQUNBQyxjQUFBMUcsVUFBQSxDQUNBLENBRUEsU0FBQThHLG1CQUNBbEgsTUFBQXlHLE9BQ0F6RyxNQUFBMEcsS0FBQSxFQUVBMUcsTUFBQTZHLE1BQUEsRUFHQTdHLE1BQUFnSCxZQUFBL0csZ0JBQUE4RyxNQUNBM0csV0FBQXVHLFlBQUFDLGVBQUEsSUFBQSxFQUFBLENBQ0EsQ0FFQSxTQUFBTyxvQkFDQW5ILE1BQUFvSCxPQUFBbEgsYUFBQTZHLE1BQUEsRUFDQSxDQUVBLFNBQUFNLFVBQ0EsSUFBQXJILE1BQUFvSCxRQUNBcEgsTUFBQW9ILE9BQUFqSCxXQUNBRCxhQUFBNkcsTUFBQSxHQUFBNUcsYUFFQUEsV0FBQUgsTUFBQW9ILE9BQ0FwSCxNQUFBb0gsT0FBQSxFQUNBbEgsYUFBQTZHLE1BQUEsRUFFQSxDSS9EQXpLLEVBQUEsaUJBQUEsRUFBQTZGLE1BQUEsU0FBQS9FLEdBQ0EsSUFBQUUsRUFBQWhCLEVBQUFjLEVBQUFHLGFBQUEsRUFDQWpDLEVBQUFnQyxFQUFBZCxRQUFBLE9BQUEsRUFDQWMsRUFBQWQsUUFBQSxhQUFBLEVBRUFpQixTQUFBLFFBQUEsRUFDQTBJLGVBQUE3SyxDQUFBLEdBRUE2SyxlQUFBN0ssQ0FBQSxFQUNBTSxTQUFBMEIsQ0FBQSxFQUVBLENBQUEsRUoxQkErQixTQUFBVSxpQkFBQSxtQkFBQSxTQUFBM0MsSUFDQTRDLE1BQUFYLFNBQUFpSSxlQUFBLE9BQUEsR0FFQXZILGlCQUFBLFFBQUF1RyxRQUFBLEVBR0EsSUFEQSxJQUFBaUIsRUFBQWxJLFNBQUFLLGlCQUFBLE9BQUEsRUFDQThILEVBQUEsRUFBQUEsRUFBQUQsRUFBQTdLLE9BQUE4SyxDQUFBLEdBQ0FELEVBQUFDLEdBQUF6SCxpQkFBQSxRQUFBdUcsUUFBQSxFQUdBakgsU0FBQWlJLGVBQUEsVUFBQSxFQUNBdkgsaUJBQUEsUUFBQXNILE9BQUEsR0FFQXBILGdCQUFBWixTQUFBaUksZUFBQSxlQUFBLEdBQ0F2SCxpQkFBQSxZQUFBa0gsWUFBQSxFQUNBaEgsZ0JBQUFGLGlCQUFBLFFBQUFtSCxnQkFBQSxFQUVBakgsZ0JBQUF3SCxJQUFBLEVBQ0F4SCxnQkFBQThHLE1BQUEsR0FFQTdHLGFBQUFiLFNBQUFpSSxlQUFBLGFBQUEsR0FDQXZILGlCQUFBLFFBQUFvSCxpQkFBQSxFQUNBakgsYUFBQUgsaUJBQUEsVUFBQW9ILGlCQUFBLEVBRUFqSCxhQUFBdUgsSUFBQSxFQUNBdkgsYUFBQXFHLElBQUEsR0FFQXJHLGFBQUE2RyxNQUFBN0csYUFBQXFHLEdBQ0EsQ0FBQSIsImZpbGUiOiJtYWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKCgpID0+IHtcclxuICBjb25zdCBtZXN1cmVXaWR0aCA9IChpdGVtKSA9PiB7XHJcbiAgICBsZXQgcmVxSXRlbVdpZHRoID0gMDtcclxuXHJcbiAgICBjb25zdCBzY3JlZW5XaWR0aCA9ICQod2luZG93KS53aWR0aCgpO1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gaXRlbS5jbG9zZXN0KFwiLmNvbG9yc19fbWVudVwiKTtcclxuICAgIGNvbnN0IHRpdGxlc0Jsb2NrcyA9IGNvbnRhaW5lci5maW5kKFwiLmNvbG9yc19fYnV0dG9uXCIpO1xyXG4gICAgY29uc3QgdGl0bGVXaWR0aCA9IHRpdGxlc0Jsb2Nrcy53aWR0aCgpICogdGl0bGVzQmxvY2tzLmxlbmd0aDtcclxuXHJcbiAgICBjb25zdCB0ZXh0Q29udGFpbmVyID0gaXRlbS5maW5kKFwiLmNvbG9yc19fY29udGFpbmVyXCIpO1xyXG4gICAgY29uc3QgcGFkZGluZ0xlZnQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctbGVmdFwiKSk7XHJcbiAgICBjb25zdCBwYWRkaW5nUmlnaHQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctcmlnaHRcIikpO1xyXG4gICAgXHJcbiAgICBjb25zdCBpc1RhYmxldCA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNzY4cHgpXCIpLm1hdGNoZXM7XHJcbiAgICBjb25zdCBpc01vYmlsZSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNDgwcHgpXCIpLm1hdGNoZXM7XHJcblxyXG4gICAgaWYgKGlzVGFibGV0KSB7XHJcbiAgICAgICByZXFJdGVtV2lkdGggPSBzY3JlZW5XaWR0aCAtIHRpdGxlV2lkdGg7XHJcbiAgICB9IGlmIChpc01vYmlsZSkge1xyXG4gICAgICByZXFJdGVtV2lkdGggPSBzY3JlZW5XaWR0aCAtIHRpdGxlc0Jsb2Nrcy53aWR0aCgpO1xyXG4gICAgfSBpZiAoIWlzVGFibGV0ICYmICFpc01vYmlsZSkge1xyXG4gICAgICByZXFJdGVtV2lkdGggPSA1MjQ7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY29udGFpbmVyOiByZXFJdGVtV2lkdGgsXHJcbiAgICAgIHRleHRDb250YWluZXI6IHJlcUl0ZW1XaWR0aCAtIHBhZGRpbmdSaWdodCAtIHBhZGRpbmdMZWZ0XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lciA9IChjb250YWluZXIpID0+IHtcclxuICAgIGNvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIuY29sb3JzX19pdGVtXCIpO1xyXG4gICAgY29uc3QgY29udGVudCA9IGNvbnRhaW5lci5maW5kKFwiLmNvbG9yc19fY29udGVudFwiKTtcclxuXHJcbiAgICBpdGVtcy5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTsgIFxyXG4gICAgY29udGVudC53aWR0aCgwKTtcclxuICB9XHJcbiAgXHJcbiAgY29uc3Qgb3Blbkl0ZW0gPSAoaXRlbSkgPT4ge1xyXG4gICAgY29uc3QgaGlkZGVuQ29udGVudCA9IGl0ZW0uZmluZChcIi5jb2xvcnNfX2NvbnRlbnRcIik7XHJcbiAgICBjb25zdCByZXFXaWR0aCA9IG1lc3VyZVdpZHRoKGl0ZW0pO1xyXG4gICAgY29uc3QgdGV4dEJsb2NrID0gaXRlbS5maW5kKFwiLmNvbG9yc19fY29udGFpbmVyXCIpO1xyXG5cclxuICAgIGl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICBoaWRkZW5Db250ZW50LndpZHRoKHJlcVdpZHRoLmNvbnRhaW5lcik7XHJcbiAgICB0ZXh0QmxvY2sud2lkdGgocmVxV2lkdGgudGV4dENvbnRhaW5lcik7XHJcbiAgfVxyXG4gIFxyXG4gICQoXCIuY29sb3JzX19idXR0b25cIikub24oXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIFxyXG4gICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7ICBcclxuICAgIGNvbnN0IGl0ZW0gPSAkdGhpcy5jbG9zZXN0KFwiLmNvbG9yc19faXRlbVwiKTtcclxuICAgIGNvbnN0IGl0ZW1PcGVuZWQgPSBpdGVtLmhhc0NsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gJHRoaXMuY2xvc2VzdChcIi5jb2xvcnNfX21lbnVcIik7XHJcblxyXG4gICAgaWYgKGl0ZW1PcGVuZWQpIHtcclxuICAgICAgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lcihjb250YWluZXIpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyKGNvbnRhaW5lcilcclxuICAgICAgb3Blbkl0ZW0oaXRlbSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gICQoXCIuY29sb3JzX19jbG9zZVwiKS5vbihcImNsaWNrXCIsIGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIoJCgnLmNvbG9yc19fbWVudScpKTtcclxuICB9KVxyXG59KSgpXHJcblxyXG5cclxuIiwibGV0IG15TWFwO1xyXG5cclxuY29uc3QgaW5pdCA9ICgpID0+IHtcclxuICBteU1hcCA9IG5ldyB5bWFwcy5NYXAoXCJtYXBcIiwge1xyXG4gICAgY2VudGVyOiBbNTIuMDI5MjIyLCA0Ny44MzA2NjZdLFxyXG4gICAgem9vbTogMTIsXHJcbiAgICBjb250cm9sczogW11cclxuICB9KTtcclxuXHJcbiAgY29uc3QgY29vcmRzID0gW1xyXG4gICAgWzUyLjAxMDg5MiwgNDcuODA5ODY2XSxcclxuICAgIFs1Mi4wMjg5NDMsIDQ3LjgzMTU4OF0sXHJcbiAgICBbNTIuMDEzMDcwLCA0Ny44MjMyMDZdLFxyXG4gICAgWzUyLjAyODM0MiwgNDcuNzgxNjY4XVxyXG4gIF07XHJcblxyXG4gIGNvbnN0IG15Q29sbGVjdGlvbiA9IG5ldyB5bWFwcy5HZW9PYmplY3RDb2xsZWN0aW9uKHt9LCB7XHJcbiAgICBkcmFnZ2FibGU6IGZhbHNlLFxyXG4gICAgaWNvbkxheW91dDogJ2RlZmF1bHQjaW1hZ2UnLFxyXG4gICAgaWNvbkltYWdlSHJlZjogJy4vaW1nL3N2Zy9tYXJrZXIuc3ZnJyxcclxuICAgIGljb25JbWFnZVNpemU6IFszMCwgNDJdLFxyXG4gICAgaWNvbkltYWdlT2Zmc2V0OiBbLTMsIC00Ml1cclxuICB9KTtcclxuXHJcbiAgY29vcmRzLmZvckVhY2goY29vcmQgPT4ge1xyXG4gICAgbXlDb2xsZWN0aW9uLmFkZChuZXcgeW1hcHMuUGxhY2VtYXJrKGNvb3JkKSk7XHJcbiAgfSk7XHJcblxyXG4gIG15TWFwLmdlb09iamVjdHMuYWRkKG15Q29sbGVjdGlvbik7XHJcblxyXG4gIG15TWFwLmJlaGF2aW9ycy5kaXNhYmxlKCdzY3JvbGxab29tJyk7XHJcblxyXG4gIG15TWFwLmNvbnRyb2xzLmFkZCgnem9vbUNvbnRyb2wnLCB7XHJcbiAgICBmbG9hdDogJ25vbmUnLFxyXG4gICAgcG9zaXRpb246IHtcclxuICAgICAgICByaWdodDogNDAsXHJcbiAgICAgICAgdG9wOiA1XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbnltYXBzLnJlYWR5KGluaXQpOyIsImxldCBoYW1idXJnZXIgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhhbWJ1cmdlcicpO1xyXG5sZXQgbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZW51Jyk7XHJcbmxldCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xyXG5cclxubGV0IGxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnVfX2xpbmsnKTtcclxuXHJcbmxpbmtzLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XHJcbiAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycgLCB0b2dnbGVNZW51KTtcclxufSlcclxuXHJcbmZ1bmN0aW9uIHRvZ2dsZU1lbnUoKXtcclxuICBoYW1idXJnZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGFtYnVyZ2VyLS1hY3RpdmUnKTtcclxuICBtZW51LmNsYXNzTGlzdC50b2dnbGUoJ21lbnUtLWFjdGl2ZScpO1xyXG4gIGJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnYm9keS0tYWN0aXZlLW1lbnUnKTtcclxufVxyXG5cclxuaGFtYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyAsIHRvZ2dsZU1lbnUpO1xyXG5cclxuXHJcbiIsImNvbnN0IHZhbGlkYXRlRmllbGRzID0gKGZvcm0sIGZpZWxkc0FycmF5KSA9PiB7XHJcblxyXG4gIGZpZWxkc0FycmF5LmZvckVhY2goZmllbGQgPT4ge1xyXG4gICAgZmllbGQucmVtb3ZlQ2xhc3MoXCJpbnB1dC1lcnJvclwiKTtcclxuICAgIGlmIChmaWVsZC52YWwoKS50cmltKCkgPT09IFwiXCIpIHtcclxuICAgICAgZmllbGQuYWRkQ2xhc3MoXCJpbnB1dC1lcnJvclwiKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgY29uc3QgZXJyb3JGaWVsZHMgPSBmb3JtLmZpbmQoXCIuaW5wdXQtZXJyb3JcIik7XHJcblxyXG4gIHJldHVybiBlcnJvckZpZWxkcy5sZW5ndGggPT09IDA7XHJcbn1cclxuXHJcbiQoJy5mb3JtJykuc3VibWl0KGUgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3QgZm9ybSA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICBjb25zdCBuYW1lID0gZm9ybS5maW5kKFwiW25hbWU9J25hbWUnXVwiKTtcclxuICBjb25zdCBwaG9uZSA9IGZvcm0uZmluZChcIltuYW1lPSdwaG9uZSddXCIpO1xyXG4gIGNvbnN0IGNvbW1lbnQgPSBmb3JtLmZpbmQoXCJbbmFtZT0nY29tbWVudCddXCIpO1xyXG4gIGNvbnN0IHRvID0gZm9ybS5maW5kKFwiW25hbWU9J3RvJ11cIik7XHJcblxyXG4gIGNvbnN0IG1vZGFsID0gJChcIiNtb2RhbFwiKTtcclxuICBjb25zdCBjb250ZW50ID0gbW9kYWwuZmluZChcIi5tb2RhbF9fY29udGVudFwiKTtcclxuXHJcbiAgbW9kYWwucmVtb3ZlQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcclxuXHJcbiAgY29uc3QgaXNWYWxpZCA9IHZhbGlkYXRlRmllbGRzKGZvcm0sIFtuYW1lLCBwaG9uZSwgY29tbWVudCwgdG9dKTtcclxuXHJcbiAgaWYgKGlzVmFsaWQpIHtcclxuICAgIGNvbnN0IHJlcXVlc3QgPSAkLmFqYXgoe1xyXG4gICAgICB1cmw6IFwiaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsXCIsXHJcbiAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICBuYW1lOiBuYW1lLnZhbCgpLFxyXG4gICAgICAgIHBob25lOiBwaG9uZS52YWwoKSxcclxuICAgICAgICBjb21tZW50OiBjb21tZW50LnZhbCgpLFxyXG4gICAgICAgIHRvOiB0by52YWwoKSxcclxuICAgICAgfSxcclxuICAgIH0pOyBcclxuXHJcbiAgICByZXF1ZXN0LmRvbmUoKGRhdGEpID0+IHtcclxuICAgICAgY29udGVudC50ZXh0KGRhdGEubWVzc2FnZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXF1ZXN0LmZhaWwoKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgbWVzc2FnZSA9IGRhdGE/LnJlc3BvbnNlSlNPTj8ubWVzc2FnZSA/PyAn0J/RgNC+0LjQt9C+0YjQu9CwINC+0YjQuNCx0LrQsCwg0L/QvtC/0YDQvtCx0YPQudGC0LUg0L/QvtC30LbQtSc7XHJcbiAgICAgIGNvbnRlbnQudGV4dChtZXNzYWdlKTtcclxuICAgICAgbW9kYWwuYWRkQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJlcXVlc3QuYWx3YXlzKCgpID0+IHtcclxuICAgICAgJC5mYW5jeWJveC5vcGVuKHtcclxuICAgICAgICBzcmM6IFwiI21vZGFsXCIsXHJcbiAgICAgICAgdHlwZTogXCJpbmxpbmVcIlxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcbiAgXHJcblxyXG4kKFwiLmFwcC1zdWJtaXQtYnRuXCIpLmNsaWNrKChlKSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAkLmZhbmN5Ym94LmNsb3NlKCk7XHJcbn0pOyIsImxldCB2aWRlbztcclxubGV0IGR1cmF0aW9uQ29udHJvbDtcclxubGV0IHNvdW5kQ29udHJvbDtcclxubGV0IHNvdW5kTGV2ZWw7ICAgXHJcbmxldCBpbnRlcnZhbElkO1xyXG5cclxuXHJcbmRvY3VtZW50LmFkZEV2ZW50TGlzdGVuZXIoJ0RPTUNvbnRlbnRMb2FkZWQnLCBlID0+IHtcclxuICB2aWRlbyA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd2aWRlbycpO1xyXG5cclxuICB2aWRlby5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHBsYXlTdG9wKTtcclxuXHJcbiAgbGV0IHBsYXlCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLnBsYXknKTtcclxuICBmb3IgKGxldCBpID0gMDsgaSA8IHBsYXlCdXR0b25zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICBwbGF5QnV0dG9uc1tpXS5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHBsYXlTdG9wKTtcclxuICB9XHJcblxyXG4gIGxldCBtaWNDb250cm9sID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ21pY0xldmVsJyk7XHJcbiAgbWljQ29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNvdW5kT2YpO1xyXG5cclxuICBkdXJhdGlvbkNvbnRyb2wgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgnZHVyYXRpb25MZXZlbCcpO1xyXG4gIGR1cmF0aW9uQ29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZWRvd24nLCBzdG9wSW50ZXJ2YWwpO1xyXG4gIGR1cmF0aW9uQ29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsIHNldFZpZGVvRHVyYXRpb24pO1xyXG5cclxuICBkdXJhdGlvbkNvbnRyb2wubWluID0gMDtcclxuICBkdXJhdGlvbkNvbnRyb2wudmFsdWUgPSAwO1xyXG5cclxuICBzb3VuZENvbnRyb2wgPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndm9sdW1lTGV2ZWwnKTtcclxuICBzb3VuZENvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBjaGFuZ2VTb3VuZFZvbHVtZSk7XHJcbiAgc291bmRDb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ21vdXNldXAnLCBjaGFuZ2VTb3VuZFZvbHVtZSk7XHJcblxyXG4gIHNvdW5kQ29udHJvbC5taW4gPSAwO1xyXG4gIHNvdW5kQ29udHJvbC5tYXggPSAxMDtcclxuXHJcbiAgc291bmRDb250cm9sLnZhbHVlID0gc291bmRDb250cm9sLm1heDtcclxufSlcclxuXHJcbmZ1bmN0aW9uIHBsYXlTdG9wKCkge1xyXG4gIGxldCBwbGF5SW1nID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLnZpZGVvX19wbGF5Jyk7XHJcbiAgcGxheUltZy5jbGFzc0xpc3QudG9nZ2xlKCd2aWRlb19fcGxheS0tYWN0aXZlJyk7XHJcblxyXG4gIGR1cmF0aW9uQ29udHJvbC5tYXggPSB2aWRlby5kdXJhdGlvbjtcclxuXHJcbiAgaWYodmlkZW8ucGF1c2VkKSB7XHJcbiAgICB2aWRlby5wbGF5KCk7XHJcbiAgICBpbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwodXBkYXRlRHVyYXRpb24sIDEwMDAgLzY2KTtcclxuICB9IGVsc2V7XHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG4gICAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTtcclxuICB9XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHVwZGF0ZUR1cmF0aW9uKCkge1xyXG4gIGR1cmF0aW9uQ29udHJvbC52YWx1ZSA9IHZpZGVvLmN1cnJlbnRUaW1lO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzdG9wSW50ZXJ2YWwgKCkge1xyXG4gIHZpZGVvLnBhdXNlKCk7XHJcbiAgY2xlYXJJbnRlcnZhbChpbnRlcnZhbElkKTtcclxufVxyXG5cclxuZnVuY3Rpb24gc2V0VmlkZW9EdXJhdGlvbiAoKSB7XHJcbiAgaWYodmlkZW8ucGF1c2VkKSB7XHJcbiAgICB2aWRlby5wbGF5KCk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHZpZGVvLnBhdXNlKCk7XHJcbiAgfVxyXG5cclxuICB2aWRlby5jdXJyZW50VGltZSA9IGR1cmF0aW9uQ29udHJvbC52YWx1ZTtcclxuICBpbnRlcnZhbElkID0gc2V0SW50ZXJ2YWwodXBkYXRlRHVyYXRpb24sIDEwMDAgLzY2KTtcclxufVxyXG5cclxuZnVuY3Rpb24gY2hhbmdlU291bmRWb2x1bWUoKSB7XHJcbiAgdmlkZW8udm9sdW1lID0gc291bmRDb250cm9sLnZhbHVlIC8gMTA7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNvdW5kT2YoKSB7XHJcbiAgaWYodmlkZW8udm9sdW1lID09PSAwKXtcclxuICAgIHZpZGVvLnZvbHVtZSA9IHNvdW5kTGV2ZWw7XHJcbiAgICBzb3VuZENvbnRyb2wudmFsdWUgPSBzb3VuZExldmVsICogMTA7XHJcbiAgfSBlbHNle1xyXG4gICAgc291bmRMZXZlbCA9IHZpZGVvLnZvbHVtZTtcclxuICAgIHZpZGVvLnZvbHVtZSA9IDA7XHJcbiAgICBzb3VuZENvbnRyb2wudmFsdWUgPSAwO1xyXG4gIH1cclxufSIsImNvbnN0IGZpbmRCbG9ja0J5QWxpYXMgPSBhbGlhcyA9PiB7XHJcbiAgcmV0dXJuICQoXCIucmV2aWV3c19faXRlbVwiKS5maWx0ZXIoKG5keCwgaXRlbSkgPT4ge1xyXG4gICAgcmV0dXJuICQoaXRlbSkuYXR0cihcImRhdGEtbGlua2VkLXdpdGhcIikgPT09IGFsaWFzO1xyXG4gIH0pXHJcbn1cclxuXHJcbiQoXCIucmV2aWV3cy1zd2l0Y2hlcl9fbGlua1wiKS5jbGljayhlID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLW9wZW5cIik7XHJcbiAgY29uc3QgaXRlbVRvU2hvdyA9IGZpbmRCbG9ja0J5QWxpYXModGFyZ2V0KTtcclxuICBjb25zdCBjdXJJdGVtID0gJHRoaXMuY2xvc2VzdChcIi5yZXZpZXdzLXN3aXRjaGVyX19pdGVtXCIpO1xyXG5cclxuICBpdGVtVG9TaG93LmFkZENsYXNzKFwiYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgY3VySXRlbS5hZGRDbGFzcyhcImFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG59KTsiLCJjb25zdCBzZWN0aW9ucyA9ICQoXCJzZWN0aW9uXCIpO1xyXG5jb25zdCBkaXNwbGF5ID0gJChcIi53cmFwcGVyX19jb250ZW50XCIpO1xyXG5jb25zdCBzaWRlTWVudSA9ICQoXCIuZml4ZWQtbWVudVwiKTtcclxuY29uc3QgbWVudUl0ZW1zID0gc2lkZU1lbnUuZmluZChcIi5maXhlZC1tZW51X19pdGVtXCIpO1xyXG5cclxuY29uc3QgbW9iaWxlRGV0ZWN0ID0gbmV3IE1vYmlsZURldGVjdCh3aW5kb3cubmF2aWdhdG9yLnVzZXJBZ2VudCk7XHJcbmNvbnN0IGlzTW9iaWxlID0gbW9iaWxlRGV0ZWN0Lm1vYmlsZSgpO1xyXG5cclxubGV0IGluU2Nyb2xsID0gZmFsc2U7XHJcblxyXG5zZWN0aW9ucy5maXJzdCgpLmFkZENsYXNzKFwiYWN0aXZlXCIpO1xyXG5cclxuY29uc3QgY291bnRTZWN0aW9uUG9zaXRpb24gPSAoc2VjdGlvbkVxKSA9PiB7XHJcbiAgY29uc3QgcG9zaXRpb24gPSBzZWN0aW9uRXEgKiAtMTAwO1xyXG5cclxuICBpZihpc05hTihwb3NpdGlvbikpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCLQv9C10YDQtdC00LDQvdC+INC90LXQstC10YDQvdC+0LUg0LfQvdCw0YfQtdC90LjQtSDQsiAgY291bnRTZWN0aW9uUG9zaXRpb25cIik7XHJcbiAgICByZXR1cm4gMDtcclxuICB9XHJcblxyXG4gIHJldHVybiBwb3NpdGlvbjtcclxufVxyXG5cclxuY29uc3QgY2hhbmdlTWVudVRoZW1lRm9yU2VjdGlvbiA9IChzZWN0aW9uRXEpID0+IHtcclxuICBjb25zdCBjdXJyZW50U2VjdGlvbiA9IHNlY3Rpb25zLmVxKHNlY3Rpb25FcSk7XHJcbiAgY29uc3QgbWVudVRoZW1lID0gY3VycmVudFNlY3Rpb24uYXR0cihcImRhdGEtc2lkZW1lbnUtdGhlbWVcIik7XHJcbiAgY29uc3QgYWN0aXZlQ2xhc3MgPSBcImZpeGVkLW1lbnUtLXNoYWRvd2VkXCI7XHJcbiAgXHJcbiAgaWYobWVudVRoZW1lID09PSBcIndoaXRlXCIpIHtcclxuICAgIHNpZGVNZW51LmFkZENsYXNzKGFjdGl2ZUNsYXNzKTtcclxuICB9IGVsc2Uge1xyXG4gICAgc2lkZU1lbnUucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG4gIH1cclxufTtcclxuXHJcbmNvbnN0IHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtID0gKGl0ZW1zLCBpdGVtRXEsIGFjdGl2ZUNsYXNzKSA9PiB7XHJcbiAgaXRlbXMuZXEoaXRlbUVxKS5hZGRDbGFzcyhhY3RpdmVDbGFzcykuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhhY3RpdmVDbGFzcyk7XHJcbn1cclxuXHJcbmNvbnN0IHBlcmZvcm1UcmFuc2l0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xyXG4gIGlmKGluU2Nyb2xsKSByZXR1cm47XHJcblxyXG4gIGNvbnN0IHRyYW5zaXRpb25PdmVyID0gMTAwMDtcclxuICBjb25zdCBtb3VzZUluZXJ0aWFPdmVyID0gMzAwO1xyXG5cclxuICBpblNjcm9sbCA9IHRydWU7XHJcblxyXG4gICAgY29uc3QgcG9zaXRpb24gPSBjb3VudFNlY3Rpb25Qb3NpdGlvbihzZWN0aW9uRXEpO1xyXG5cclxuICAgIGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24oc2VjdGlvbkVxKTtcclxuXHJcbiAgICBkaXNwbGF5LmNzcyh7XHJcbiAgICAgIHRyYW5zZm9ybTogYHRyYW5zbGF0ZVkoJHtwb3NpdGlvbn0lKWAsXHJcbiAgICB9KTtcclxuXHJcbiAgICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShzZWN0aW9ucywgc2VjdGlvbkVxLCBcImFjdGl2ZVwiKTtcclxuXHJcbiAgICAvL3NlY3Rpb25zLmVxKHNlY3Rpb25FcSkuYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuXHJcbiAgICAvL3NpZGVNZW51LmZpbmQoXCIuZml4ZWQtbWVudV9faXRlbVwiKS5lcShzZWN0aW9uRXEpLmFkZENsYXNzKFwiYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcblxyXG4gICAgc2V0VGltZW91dCgoKSA9PiB7XHJcbiAgICAgIGluU2Nyb2xsID0gZmFsc2U7XHJcbiAgICAgIHJlc2V0QWN0aXZlQ2xhc3NGb3JJdGVtKG1lbnVJdGVtcywgc2VjdGlvbkVxLCBcImZpeGVkLW1lbnVfX2l0ZW0tLWFjdGl2ZVwiKTtcclxuICAgIH0sIHRyYW5zaXRpb25PdmVyICsgbW91c2VJbmVydGlhT3Zlcik7XHJcbiAgXHJcbn07XHJcblxyXG5jb25zdCB2aWV3cG9ydFNjcm9sbGVyID0gKCkgPT4geyBcclxuICBjb25zdCBhY3RpdmVTZWN0aW9uID0gc2VjdGlvbnMuZmlsdGVyKFwiLmFjdGl2ZVwiKTtcclxuICBjb25zdCBuZXh0U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ubmV4dCgpO1xyXG4gIGNvbnN0IHByZXZTZWN0aW9uID0gYWN0aXZlU2VjdGlvbi5wcmV2KCk7XHJcbiAgXHJcblxyXG4gIHJldHVybiB7XHJcbiAgICBuZXh0KCkge1xyXG4gICAgICBpZihuZXh0U2VjdGlvbi5sZW5ndGgpIHtcclxuICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihuZXh0U2VjdGlvbi5pbmRleCgpKTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICAgIHByZXYoKSB7XHJcbiAgICAgIGlmKHByZXZTZWN0aW9uLmxlbmd0aCkge1xyXG4gICAgICAgIHBlcmZvcm1UcmFuc2l0aW9uKHByZXZTZWN0aW9uLmluZGV4KCkpO1xyXG4gICAgICB9XHJcbiAgICB9LFxyXG4gIH07XHJcbn07XHJcblxyXG4kKHdpbmRvdykub24oXCJ3aGVlbFwiLCBlID0+IHtcclxuICBjb25zdCBkZWx0YVkgPSBlLm9yaWdpbmFsRXZlbnQuZGVsdGFZO1xyXG4gIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xyXG5cclxuICBpZiAoZGVsdGFZID4wKSB7XHJcbiAgICBzY3JvbGxlci5uZXh0KCk7XHJcbiAgfVxyXG5cclxuICBpZiAoZGVsdGFZIDwwKSB7XHJcbiAgICBzY3JvbGxlci5wcmV2KCk7XHJcbiAgfVxyXG59KTtcclxuXHJcbiQod2luZG93KS5vbihcImtleWRvd25cIiwgZSA9PiB7XHJcbiAgY29uc3QgdGFnTmFtZSA9IGUudGFyZ2V0LnRhZ05hbWUudG9Mb3dlckNhc2UoKTtcclxuICBjb25zdCB1c2VyVHlwaW5nSW5JbnB1dHMgPSB0YWdOYW1lID09PSBcImlucHV0XCIgfHwgdGFnTmFtZSA9PT0gXCJ0ZXh0YXJlYVwiO1xyXG4gIGNvbnN0IHNjcm9sbGVyID0gdmlld3BvcnRTY3JvbGxlcigpO1xyXG5cclxuICBpZiAodXNlclR5cGluZ0luSW5wdXRzKSByZXR1cm47IFxyXG4gICAgc3dpdGNoIChlLmNvZGUpIHtcclxuICAgICAgY2FzZSAzODpcclxuICAgICAgICBzY3JvbGxlci5wcmV2KCk7XHJcbiAgICAgICAgYnJlYWs7XHJcbiAgXHJcbiAgICAgIGNhc2UgNDA6XHJcbiAgICAgICAgc2Nyb2xsZXIubmV4dCgpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gICAgfVxyXG59KTtcclxuXHJcbiQoXCIud3JhcHBlclwiKS5vbihcInRvdWNobW92ZVwiLCBlID0+IGUucHJldmVudERlZmF1bHQoKSk7XHJcblxyXG4kKFwiW2RhdGEtc2Nyb2xsLXRvXVwiKS5jbGljayhlID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcblxyXG4gIGNvbnN0ICR0aGlzID0gJChlLmN1cnJlbnRUYXJnZXQpO1xyXG4gIGNvbnN0IHRhcmdldCA9ICR0aGlzLmF0dHIoXCJkYXRhLXNjcm9sbC10b1wiKTtcclxuICBjb25zdCByZXFTZWN0aW9uID0gJChgW2RhdGEtc2VjdGlvbi1pZD0ke3RhcmdldH1dYCk7XHJcblxyXG4gIHBlcmZvcm1UcmFuc2l0aW9uKHJlcVNlY3Rpb24uaW5kZXgoKSk7XHJcbn0pO1xyXG5cclxuaWYgKGlzTW9iaWxlKSB7XHJcbiAgLy9odHRwczovL2dpdGh1Yi5jb20vbWF0dGJyeXNvbi9Ub3VjaFN3aXBlLUpxdWVyeS1QbHVnaW5cclxuICAkKFwiYm9keVwiKS5zd2lwZSh7XHJcbiAgICBzd2lwZTogZnVuY3Rpb24oZXZlbnQsIGRpcmVjdGlvbikge1xyXG4gICAgICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuICAgICAgbGV0IHNjcm9sbERpcmVjdGlvbiA9IFwiXCI7XHJcblxyXG4gICAgICBpZihkaXJlY3Rpb24gPT09IFwidXBcIikgc2Nyb2xsRGlyZWN0aW9uID0gXCJuZXh0XCI7XHJcbiAgICAgIGlmKGRpcmVjdGlvbiA9PT0gXCJkb3duXCIpIHNjcm9sbERpcmVjdGlvbiA9IFwicHJldlwiO1xyXG4gICAgICBpZighc2Nyb2xsRGlyZWN0aW9uKSByZXR1cm47XHJcbiAgICAgIHNjcm9sbGVyW3Njcm9sbERpcmVjdGlvbl0oKTtcclxuICAgIH0sXHJcbiAgfSk7XHJcbn1cclxuXHJcbiIsImNvbnN0IHNsaWRlciA9ICQoXCIuc2xpZGVyX19saXN0XCIpLmJ4U2xpZGVyKHtcclxuICBwYWdlcjogZmFsc2UsXHJcbiAgY29udHJvbHM6IGZhbHNlXHJcbn0pO1xyXG5cclxuJCgnLnNsaWRlcl9fYXJyb3ctLWxlZnQnKS5jbGljayhlID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgc2xpZGVyLmdvVG9QcmV2U2xpZGUoKTtcclxufSlcclxuXHJcbiQoJy5zbGlkZXJfX2Fycm93LS1yaWdodCcpLmNsaWNrKGUgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBzbGlkZXIuZ29Ub05leHRTbGlkZSgpO1xyXG59KSIsImNvbnN0IG9wZW5JdGVtID0gaXRlbSA9PiB7XHJcbiAgY29uc3QgY29udGFpbmVyID0gaXRlbS5jbG9zZXN0KFwiLnRlYW1fX2l0ZW1cIik7XHJcbiAgY29uc3QgY29udGVudEJsb2NrID0gY29udGFpbmVyLmZpbmQoXCIudGVhbV9fY29udGVudFwiKTtcclxuICBjb25zdCB0ZXh0QmxvY2sgPSBjb250ZW50QmxvY2suZmluZChcIi50ZWFtX19jb250ZW50LWJsb2NrXCIpO1xyXG4gIGNvbnN0IHJlcUhlaWdodCA9IHRleHRCbG9jay5oZWlnaHQoKTtcclxuICBjb25zdCByZWN0YW5nbGVQb3NpdGlvbiA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2Ryb3Bkb3duLWljb25cIik7XHJcblxyXG4gIGNvbnRhaW5lci5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICBjb250ZW50QmxvY2suaGVpZ2h0KHJlcUhlaWdodCk7XHJcbiAgcmVjdGFuZ2xlUG9zaXRpb24uYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbn1cclxuXHJcbmNvbnN0IGNsb3NlRXZlcnlJdGVtID0gY29udGFpbmVyID0+IHtcclxuICBjb25zdCBpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2NvbnRlbnRcIik7XHJcbiAgY29uc3QgaXRlbUNvbnRhaW5lciA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2l0ZW1cIik7XHJcbiAgY29uc3QgaXRlbVJlY3RhbmdsZSA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2Ryb3Bkb3duLWljb25cIik7XHJcblxyXG4gIGl0ZW1Db250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgaXRlbVJlY3RhbmdsZS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICBpdGVtcy5oZWlnaHQoMCk7XHJcbn0gXHJcblxyXG4kKCcudGVhbV9fZHJvcGRvd24nKS5jbGljayhlID0+IHtcclxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnRlYW1cIik7XHJcbiAgY29uc3QgZWxlbUNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIudGVhbV9faXRlbVwiKTtcclxuXHJcbiAgaWYgKGVsZW1Db250YWluZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHtcclxuICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XHJcbiAgfSBlbHNlIHtcclxuICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XHJcbiAgICBvcGVuSXRlbSgkdGhpcyk7XHJcbiAgfVxyXG59KVxyXG4iXX0=
