"use strict";!function(){function o(e){var t=e.find(".colors__item"),e=e.find(".colors__content");t.removeClass("active"),e.width(0)}function i(e){var t,n,o,i,a,r,l=e.find(".colors__content"),s=(t=e,n=0,c=$(window).width(),o=t.closest(".colors__menu").find(".colors__button"),s=o.width()*o.length,t=t.find(".colors__container"),i=parseInt(t.css("padding-left")),t=parseInt(t.css("padding-right")),a=window.matchMedia("(max-width: 768px)").matches,r=window.matchMedia("(max-width: 480px)").matches,a&&(n=c-s),r&&(n=c-o.width()),{container:n=a||r?n:524,textContainer:n-t-i}),c=e.find(".colors__container");e.addClass("active"),l.width(s.container),c.width(s.textContainer)}$(".colors__button").on("click",function(e){e.preventDefault();var e=$(e.currentTarget),t=e.closest(".colors__item"),n=t.hasClass("active"),e=e.closest(".colors__menu");n?o(e):(o(e),i(t))}),$(".colors__close").on("click",function(e){e.preventDefault(),o($(".colors__menu"))})}();var myMap,init=function(){myMap=new ymaps.Map("map",{center:[52.029222,47.830666],zoom:12,controls:[]});var t=new ymaps.GeoObjectCollection({},{draggable:!1,iconLayout:"default#image",iconImageHref:"./img/svg/marker.svg",iconImageSize:[30,42],iconImageOffset:[-3,-42]});[[52.010892,47.809866],[52.028943,47.831588],[52.01307,47.823206],[52.028342,47.781668]].forEach(function(e){t.add(new ymaps.Placemark(e))}),myMap.geoObjects.add(t),myMap.behaviors.disable("scrollZoom"),myMap.controls.add("zoomControl",{float:"none",position:{right:40,top:5}})},hamburger=(ymaps.ready(init),document.querySelector(".hamburger")),menu=document.querySelector(".menu"),body=document.querySelector("body"),links=document.querySelectorAll(".menu__link");function toggleMenu(){hamburger.classList.toggle("hamburger--active"),menu.classList.toggle("menu--active"),body.classList.toggle("body--active-menu")}links.forEach(function(e){e.addEventListener("click",toggleMenu)}),hamburger.addEventListener("click",toggleMenu);var video,durationControl,soundControl,intervalId,validateFields=function(e,t){return t.forEach(function(e){e.removeClass("input-error"),""===e.val().trim()&&e.addClass("input-error")}),0===e.find(".input-error").length},findBlockByAlias=($(".form").submit(function(e){e.preventDefault();var e=$(e.currentTarget),t=e.find("[name='name']"),n=e.find("[name='phone']"),o=e.find("[name='comment']"),i=e.find("[name='to']"),a=$("#modal"),r=a.find(".modal__content");a.removeClass("error-modal"),validateFields(e,[t,n,o,i])&&((e=$.ajax({url:"https://webdev-api.loftschool.com/sendmail",method:"post",data:{name:t.val(),phone:n.val(),comment:o.val(),to:i.val()}})).done(function(e){r.text(e.message)}),e.fail(function(e){e=null!=(e=null==e||null==(e=e.responseJSON)?void 0:e.message)?e:"Произошла ошибка, попробуйте позже";r.text(e),a.addClass("error-modal")}),e.always(function(){$.fancybox.open({src:"#modal",type:"inline"})}))}),$(".app-submit-btn").click(function(e){e.preventDefault(),$.fancybox.close()}),function(n){return $(".reviews__item").filter(function(e,t){return $(t).attr("data-linked-with")===n})}),sections=($(".reviews-switcher__link").click(function(e){e.preventDefault();var e=$(e.currentTarget),t=e.attr("data-open"),t=findBlockByAlias(t),e=e.closest(".reviews-switcher__item");t.addClass("active").siblings().removeClass("active"),e.addClass("active").siblings().removeClass("active")}),$("section")),display=$(".wrapper__content"),sideMenu=$(".fixed-menu"),menuItems=sideMenu.find(".fixed-menu__item"),mobileDetect=new MobileDetect(window.navigator.userAgent),isMobile=mobileDetect.mobile(),inScroll=!1,countSectionPosition=(sections.first().addClass("active"),function(e){e*=-100;return isNaN(e)?(console.error("передано неверное значение в  countSectionPosition"),0):e}),changeMenuThemeForSection=function(e){var t="fixed-menu--shadowed";"white"===sections.eq(e).attr("data-sidemenu-theme")?sideMenu.addClass(t):sideMenu.removeClass(t)},resetActiveClassForItem=function(e,t,n){e.eq(t).addClass(n).siblings().removeClass(n)},performTransition=function(e){var t;inScroll||(inScroll=!0,t=countSectionPosition(e),changeMenuThemeForSection(e),display.css({transform:"translateY(".concat(t,"%)")}),resetActiveClassForItem(sections,e,"active"),setTimeout(function(){inScroll=!1,resetActiveClassForItem(menuItems,e,"fixed-menu__item--active")},1300))},viewportScroller=function(){var e=sections.filter(".active"),t=e.next(),n=e.prev();return{next:function(){t.length&&performTransition(t.index())},prev:function(){n.length&&performTransition(n.index())}}},slider=($(window).on("wheel",function(e){var e=e.originalEvent.deltaY,t=viewportScroller();0<e&&t.next(),e<0&&t.prev()}),$(window).on("keydown",function(e){var t=e.target.tagName.toLowerCase(),t="input"===t||"textarea"===t,n=viewportScroller();if(!t)switch(e.code){case 38:n.prev();break;case 40:n.next()}}),$(".wrapper").on("touchmove",function(e){return e.preventDefault()}),$("[data-scroll-to]").click(function(e){e.preventDefault();e=$(e.currentTarget).attr("data-scroll-to"),e=$("[data-section-id=".concat(e,"]"));performTransition(e.index())}),isMobile&&$("body").swipe({swipe:function(e,t){viewportScroller()["down"===t?"prev":"up"===t?"next":""]()}}),$(".slider__list").bxSlider({pager:!1,controls:!1})),openItem=($(".slider__arrow--left").click(function(e){e.preventDefault(),slider.goToPrevSlide()}),$(".slider__arrow--right").click(function(e){e.preventDefault(),slider.goToNextSlide()}),function(e){var e=e.closest(".team__item"),t=e.find(".team__content"),n=t.find(".team__content-block").height(),o=e.find(".team__dropdown-icon");e.addClass("active"),t.height(n),o.addClass("active")}),closeEveryItem=function(e){var t=e.find(".team__content"),n=e.find(".team__item"),e=e.find(".team__dropdown-icon");n.removeClass("active"),e.removeClass("active"),t.height(0)};function playStop(){document.querySelector(".video__play").classList.toggle("video__play--active"),durationControl.max=video.duration,video.paused?(video.play(),intervalId=setInterval(updateDuration,1e3/66)):(video.pause(),clearInterval(intervalId))}function updateDuration(){durationControl.value=video.currentTime}function stopInterval(){video.pause(),clearInterval(intervalId)}function setVideoDuration(){video.paused?video.play():video.pause(),video.currentTime=durationControl.value,intervalId=setInterval(updateDuration,1e3/66)}function changeSoundVolume(){video.volume=soundControl/10}function soundOf(){0===video.volume?(video.volume=soundLevel,soundControl.value=10*soundLevel):(soundLevel=video.volume,video.volume=0,soundControl.value=0)}$(".team__dropdown").click(function(e){var e=$(e.currentTarget),t=e.closest(".team");e.closest(".team__item").hasClass("active")?closeEveryItem(t):(closeEveryItem(t),openItem(e))}),document.addEventListener("DOMContentLoaded",function(e){(video=document.getElementById("video")).addEventListener("click",playStop);for(var t=document.querySelectorAll(".play"),n=0;n<t.length;n++)t[n].addEventListener("click",playStop);document.getElementById("micLevel").addEventListener("click",soundOf),(durationControl=document.getElementById("durationLevel")).addEventListener("mousedown",stopInterval),durationControl.addEventListener("click",setVideoDuration),durationControl.min=0,durationControl.value=0,(soundControl=document.getElementById("volumeLevel")).addEventListener("click",changeSoundVolume),soundControl.addEventListener("mouseup",changeSoundVolume),soundControl.min=0,soundControl.max=10,soundControl.value=soundControl.max});
//# sourceMappingURL=data:application/json;charset=utf8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImhvcml6b250YWwtYWNjby5qcyIsIm1hcC5qcyIsIm1lbnUuanMiLCJtb2RhbC5qcyIsInZpZGVvLmpzIiwicmV2aWV3cy5qcyIsInNjcm9sbC5qcyIsInNsaWRlci5qcyIsInRlYW0uanMiXSwibmFtZXMiOlsiY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lciIsImNvbnRhaW5lciIsIml0ZW1zIiwiZmluZCIsImNvbnRlbnQiLCJyZW1vdmVDbGFzcyIsIndpZHRoIiwib3Blbkl0ZW0iLCJpdGVtIiwicmVxSXRlbVdpZHRoIiwidGl0bGVzQmxvY2tzIiwicGFkZGluZ0xlZnQiLCJpc1RhYmxldCIsImlzTW9iaWxlIiwiaGlkZGVuQ29udGVudCIsInJlcVdpZHRoIiwic2NyZWVuV2lkdGgiLCIkIiwid2luZG93IiwiY2xvc2VzdCIsInRpdGxlV2lkdGgiLCJsZW5ndGgiLCJ0ZXh0Q29udGFpbmVyIiwicGFyc2VJbnQiLCJjc3MiLCJwYWRkaW5nUmlnaHQiLCJtYXRjaE1lZGlhIiwibWF0Y2hlcyIsInRleHRCbG9jayIsImFkZENsYXNzIiwib24iLCJlIiwicHJldmVudERlZmF1bHQiLCIkdGhpcyIsImN1cnJlbnRUYXJnZXQiLCJpdGVtT3BlbmVkIiwiaGFzQ2xhc3MiLCJteU1hcCIsImluaXQiLCJ5bWFwcyIsIk1hcCIsImNlbnRlciIsInpvb20iLCJjb250cm9scyIsIm15Q29sbGVjdGlvbiIsIkdlb09iamVjdENvbGxlY3Rpb24iLCJkcmFnZ2FibGUiLCJpY29uTGF5b3V0IiwiaWNvbkltYWdlSHJlZiIsImljb25JbWFnZVNpemUiLCJpY29uSW1hZ2VPZmZzZXQiLCJmb3JFYWNoIiwiY29vcmQiLCJhZGQiLCJQbGFjZW1hcmsiLCJnZW9PYmplY3RzIiwiYmVoYXZpb3JzIiwiZGlzYWJsZSIsImZsb2F0IiwicG9zaXRpb24iLCJyaWdodCIsInRvcCIsImhhbWJ1cmdlciIsInJlYWR5IiwiZG9jdW1lbnQiLCJxdWVyeVNlbGVjdG9yIiwibWVudSIsImJvZHkiLCJsaW5rcyIsInF1ZXJ5U2VsZWN0b3JBbGwiLCJ0b2dnbGVNZW51IiwiY2xhc3NMaXN0IiwidG9nZ2xlIiwiZWxlbWVudCIsImFkZEV2ZW50TGlzdGVuZXIiLCJ2aWRlbyIsImR1cmF0aW9uQ29udHJvbCIsInNvdW5kQ29udHJvbCIsImludGVydmFsSWQiLCJ2YWxpZGF0ZUZpZWxkcyIsImZvcm0iLCJmaWVsZHNBcnJheSIsImZpZWxkIiwidmFsIiwidHJpbSIsImZpbmRCbG9ja0J5QWxpYXMiLCJzdWJtaXQiLCJuYW1lIiwicGhvbmUiLCJjb21tZW50IiwidG8iLCJtb2RhbCIsInJlcXVlc3QiLCJhamF4IiwidXJsIiwibWV0aG9kIiwiZGF0YSIsImRvbmUiLCJ0ZXh0IiwibWVzc2FnZSIsImZhaWwiLCJfZGF0YSRyZXNwb25zZUpTT04kbWUiLCJfZGF0YSRyZXNwb25zZUpTT04iLCJyZXNwb25zZUpTT04iLCJhbHdheXMiLCJmYW5jeWJveCIsIm9wZW4iLCJzcmMiLCJ0eXBlIiwiY2xpY2siLCJjbG9zZSIsImFsaWFzIiwiZmlsdGVyIiwibmR4IiwiYXR0ciIsInNlY3Rpb25zIiwidGFyZ2V0IiwiaXRlbVRvU2hvdyIsImN1ckl0ZW0iLCJzaWJsaW5ncyIsImRpc3BsYXkiLCJzaWRlTWVudSIsIm1lbnVJdGVtcyIsIm1vYmlsZURldGVjdCIsIk1vYmlsZURldGVjdCIsIm5hdmlnYXRvciIsInVzZXJBZ2VudCIsIm1vYmlsZSIsImluU2Nyb2xsIiwiY291bnRTZWN0aW9uUG9zaXRpb24iLCJmaXJzdCIsInNlY3Rpb25FcSIsImlzTmFOIiwiY29uc29sZSIsImVycm9yIiwiY2hhbmdlTWVudVRoZW1lRm9yU2VjdGlvbiIsImFjdGl2ZUNsYXNzIiwiZXEiLCJyZXNldEFjdGl2ZUNsYXNzRm9ySXRlbSIsIml0ZW1FcSIsInBlcmZvcm1UcmFuc2l0aW9uIiwidHJhbnNmb3JtIiwiY29uY2F0Iiwic2V0VGltZW91dCIsInRyYW5zaXRpb25PdmVyIiwidmlld3BvcnRTY3JvbGxlciIsImFjdGl2ZVNlY3Rpb24iLCJuZXh0U2VjdGlvbiIsIm5leHQiLCJwcmV2U2VjdGlvbiIsInByZXYiLCJpbmRleCIsInNsaWRlciIsImRlbHRhWSIsIm9yaWdpbmFsRXZlbnQiLCJzY3JvbGxlciIsInRhZ05hbWUiLCJ0b0xvd2VyQ2FzZSIsInVzZXJUeXBpbmdJbklucHV0cyIsImNvZGUiLCJyZXFTZWN0aW9uIiwic3dpcGUiLCJldmVudCIsImRpcmVjdGlvbiIsImJ4U2xpZGVyIiwicGFnZXIiLCJnb1RvUHJldlNsaWRlIiwiZ29Ub05leHRTbGlkZSIsImNvbnRlbnRCbG9jayIsInJlcUhlaWdodCIsImhlaWdodCIsInJlY3RhbmdsZVBvc2l0aW9uIiwiY2xvc2VFdmVyeUl0ZW0iLCJpdGVtQ29udGFpbmVyIiwiaXRlbVJlY3RhbmdsZSIsInBsYXlTdG9wIiwibWF4IiwiZHVyYXRpb24iLCJwYXVzZWQiLCJwbGF5Iiwic2V0SW50ZXJ2YWwiLCJ1cGRhdGVEdXJhdGlvbiIsInBhdXNlIiwiY2xlYXJJbnRlcnZhbCIsInZhbHVlIiwiY3VycmVudFRpbWUiLCJzdG9wSW50ZXJ2YWwiLCJzZXRWaWRlb0R1cmF0aW9uIiwiY2hhbmdlU291bmRWb2x1bWUiLCJ2b2x1bWUiLCJzb3VuZE9mIiwic291bmRMZXZlbCIsImdldEVsZW1lbnRCeUlkIiwicGxheUJ1dHRvbnMiLCJpIiwibWluIl0sIm1hcHBpbmdzIjoiYUFBQSxDQUFBLFdBOEJBLFNBQUFBLEVBQUFDLEdBQ0EsSUFBQUMsRUFBQUQsRUFBQUUsS0FBQSxlQUFBLEVBQ0FDLEVBQUFILEVBQUFFLEtBQUEsa0JBQUEsRUFFQUQsRUFBQUcsWUFBQSxRQUFBLEVBQ0FELEVBQUFFLE1BQUEsQ0FBQSxDQUNBLENBRUEsU0FBQUMsRUFBQUMsR0FDQSxJQXRDQUEsRUFDQUMsRUFJQUMsRUFJQUMsRUFHQUMsRUFDQUMsRUF5QkFDLEVBQUFOLEVBQUFMLEtBQUEsa0JBQUEsRUFDQVksR0F2Q0FQLEVBdUNBQSxFQXRDQUMsRUFBQSxFQUVBTyxFQUFBQyxFQUFBQyxNQUFBLEVBQUFaLE1B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YWluLmpzIiwic291cmNlc0NvbnRlbnQiOlsiKCgpID0+IHtcclxuICBjb25zdCBtZXN1cmVXaWR0aCA9IChpdGVtKSA9PiB7XHJcbiAgICBsZXQgcmVxSXRlbVdpZHRoID0gMDtcclxuXHJcbiAgICBjb25zdCBzY3JlZW5XaWR0aCA9ICQod2luZG93KS53aWR0aCgpO1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gaXRlbS5jbG9zZXN0KFwiLmNvbG9yc19fbWVudVwiKTtcclxuICAgIGNvbnN0IHRpdGxlc0Jsb2NrcyA9IGNvbnRhaW5lci5maW5kKFwiLmNvbG9yc19fYnV0dG9uXCIpO1xyXG4gICAgY29uc3QgdGl0bGVXaWR0aCA9IHRpdGxlc0Jsb2Nrcy53aWR0aCgpICogdGl0bGVzQmxvY2tzLmxlbmd0aDtcclxuXHJcbiAgICBjb25zdCB0ZXh0Q29udGFpbmVyID0gaXRlbS5maW5kKFwiLmNvbG9yc19fY29udGFpbmVyXCIpO1xyXG4gICAgY29uc3QgcGFkZGluZ0xlZnQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctbGVmdFwiKSk7XHJcbiAgICBjb25zdCBwYWRkaW5nUmlnaHQgPSBwYXJzZUludCh0ZXh0Q29udGFpbmVyLmNzcyhcInBhZGRpbmctcmlnaHRcIikpO1xyXG4gICAgXHJcbiAgICBjb25zdCBpc1RhYmxldCA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNzY4cHgpXCIpLm1hdGNoZXM7XHJcbiAgICBjb25zdCBpc01vYmlsZSA9IHdpbmRvdy5tYXRjaE1lZGlhKFwiKG1heC13aWR0aDogNDgwcHgpXCIpLm1hdGNoZXM7XHJcblxyXG4gICAgaWYgKGlzVGFibGV0KSB7XHJcbiAgICAgICByZXFJdGVtV2lkdGggPSBzY3JlZW5XaWR0aCAtIHRpdGxlV2lkdGg7XHJcbiAgICB9IGlmIChpc01vYmlsZSkge1xyXG4gICAgICByZXFJdGVtV2lkdGggPSBzY3JlZW5XaWR0aCAtIHRpdGxlc0Jsb2Nrcy53aWR0aCgpO1xyXG4gICAgfSBpZiAoIWlzVGFibGV0ICYmICFpc01vYmlsZSkge1xyXG4gICAgICByZXFJdGVtV2lkdGggPSA1MjQ7XHJcbiAgICB9XHJcblxyXG4gICAgcmV0dXJuIHtcclxuICAgICAgY29udGFpbmVyOiByZXFJdGVtV2lkdGgsXHJcbiAgICAgIHRleHRDb250YWluZXI6IHJlcUl0ZW1XaWR0aCAtIHBhZGRpbmdSaWdodCAtIHBhZGRpbmdMZWZ0XHJcbiAgICB9XHJcbiAgfTtcclxuXHJcbiAgY29uc3QgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lciA9IChjb250YWluZXIpID0+IHtcclxuICAgIGNvbnN0IGl0ZW1zID0gY29udGFpbmVyLmZpbmQoXCIuY29sb3JzX19pdGVtXCIpO1xyXG4gICAgY29uc3QgY29udGVudCA9IGNvbnRhaW5lci5maW5kKFwiLmNvbG9yc19fY29udGVudFwiKTtcclxuXHJcbiAgICBpdGVtcy5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTsgIFxyXG4gICAgY29udGVudC53aWR0aCgwKTtcclxuICB9XHJcbiAgXHJcbiAgY29uc3Qgb3Blbkl0ZW0gPSAoaXRlbSkgPT4ge1xyXG4gICAgY29uc3QgaGlkZGVuQ29udGVudCA9IGl0ZW0uZmluZChcIi5jb2xvcnNfX2NvbnRlbnRcIik7XHJcbiAgICBjb25zdCByZXFXaWR0aCA9IG1lc3VyZVdpZHRoKGl0ZW0pO1xyXG4gICAgY29uc3QgdGV4dEJsb2NrID0gaXRlbS5maW5kKFwiLmNvbG9yc19fY29udGFpbmVyXCIpO1xyXG5cclxuICAgIGl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgICBoaWRkZW5Db250ZW50LndpZHRoKHJlcVdpZHRoLmNvbnRhaW5lcik7XHJcbiAgICB0ZXh0QmxvY2sud2lkdGgocmVxV2lkdGgudGV4dENvbnRhaW5lcik7XHJcbiAgfVxyXG4gIFxyXG4gICQoXCIuY29sb3JzX19idXR0b25cIikub24oXCJjbGlja1wiLCAoZSkgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG4gIFxyXG4gICAgY29uc3QgJHRoaXMgPSAkKGUuY3VycmVudFRhcmdldCk7ICBcclxuICAgIGNvbnN0IGl0ZW0gPSAkdGhpcy5jbG9zZXN0KFwiLmNvbG9yc19faXRlbVwiKTtcclxuICAgIGNvbnN0IGl0ZW1PcGVuZWQgPSBpdGVtLmhhc0NsYXNzKFwiYWN0aXZlXCIpO1xyXG4gICAgY29uc3QgY29udGFpbmVyID0gJHRoaXMuY2xvc2VzdChcIi5jb2xvcnNfX21lbnVcIik7XHJcblxyXG4gICAgaWYgKGl0ZW1PcGVuZWQpIHtcclxuICAgICAgY2xvc2VFdmVyeUl0ZW1JbkNvbnRhaW5lcihjb250YWluZXIpXHJcbiAgICB9IGVsc2Uge1xyXG4gICAgICBjbG9zZUV2ZXJ5SXRlbUluQ29udGFpbmVyKGNvbnRhaW5lcilcclxuICAgICAgb3Blbkl0ZW0oaXRlbSk7XHJcbiAgICB9XHJcbiAgfSk7XHJcblxyXG4gICQoXCIuY29sb3JzX19jbG9zZVwiKS5vbihcImNsaWNrXCIsIGUgPT4ge1xyXG4gICAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAgIGNsb3NlRXZlcnlJdGVtSW5Db250YWluZXIoJCgnLmNvbG9yc19fbWVudScpKTtcclxuICB9KVxyXG59KSgpXHJcblxyXG5cclxuIiwibGV0IG15TWFwO1xyXG5cclxuY29uc3QgaW5pdCA9ICgpID0+IHtcclxuICBteU1hcCA9IG5ldyB5bWFwcy5NYXAoXCJtYXBcIiwge1xyXG4gICAgY2VudGVyOiBbNTIuMDI5MjIyLCA0Ny44MzA2NjZdLFxyXG4gICAgem9vbTogMTIsXHJcbiAgICBjb250cm9sczogW11cclxuICB9KTtcclxuXHJcbiAgY29uc3QgY29vcmRzID0gW1xyXG4gICAgWzUyLjAxMDg5MiwgNDcuODA5ODY2XSxcclxuICAgIFs1Mi4wMjg5NDMsIDQ3LjgzMTU4OF0sXHJcbiAgICBbNTIuMDEzMDcwLCA0Ny44MjMyMDZdLFxyXG4gICAgWzUyLjAyODM0MiwgNDcuNzgxNjY4XVxyXG4gIF07XHJcblxyXG4gIGNvbnN0IG15Q29sbGVjdGlvbiA9IG5ldyB5bWFwcy5HZW9PYmplY3RDb2xsZWN0aW9uKHt9LCB7XHJcbiAgICBkcmFnZ2FibGU6IGZhbHNlLFxyXG4gICAgaWNvbkxheW91dDogJ2RlZmF1bHQjaW1hZ2UnLFxyXG4gICAgaWNvbkltYWdlSHJlZjogJy4vaW1nL3N2Zy9tYXJrZXIuc3ZnJyxcclxuICAgIGljb25JbWFnZVNpemU6IFszMCwgNDJdLFxyXG4gICAgaWNvbkltYWdlT2Zmc2V0OiBbLTMsIC00Ml1cclxuICB9KTtcclxuXHJcbiAgY29vcmRzLmZvckVhY2goY29vcmQgPT4ge1xyXG4gICAgbXlDb2xsZWN0aW9uLmFkZChuZXcgeW1hcHMuUGxhY2VtYXJrKGNvb3JkKSk7XHJcbiAgfSk7XHJcblxyXG4gIG15TWFwLmdlb09iamVjdHMuYWRkKG15Q29sbGVjdGlvbik7XHJcblxyXG4gIG15TWFwLmJlaGF2aW9ycy5kaXNhYmxlKCdzY3JvbGxab29tJyk7XHJcblxyXG4gIG15TWFwLmNvbnRyb2xzLmFkZCgnem9vbUNvbnRyb2wnLCB7XHJcbiAgICBmbG9hdDogJ25vbmUnLFxyXG4gICAgcG9zaXRpb246IHtcclxuICAgICAgICByaWdodDogNDAsXHJcbiAgICAgICAgdG9wOiA1XHJcbiAgICB9XHJcbiAgfSk7XHJcbn1cclxuXHJcbnltYXBzLnJlYWR5KGluaXQpOyIsImxldCBoYW1idXJnZXIgID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmhhbWJ1cmdlcicpO1xyXG5sZXQgbWVudSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tZW51Jyk7XHJcbmxldCBib2R5ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignYm9keScpO1xyXG5cclxubGV0IGxpbmtzID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLm1lbnVfX2xpbmsnKTtcclxuXHJcbmxpbmtzLmZvckVhY2goZnVuY3Rpb24oZWxlbWVudCl7XHJcbiAgZWxlbWVudC5hZGRFdmVudExpc3RlbmVyKCdjbGljaycgLCB0b2dnbGVNZW51KTtcclxufSlcclxuXHJcbmZ1bmN0aW9uIHRvZ2dsZU1lbnUoKXtcclxuICBoYW1idXJnZXIuY2xhc3NMaXN0LnRvZ2dsZSgnaGFtYnVyZ2VyLS1hY3RpdmUnKTtcclxuICBtZW51LmNsYXNzTGlzdC50b2dnbGUoJ21lbnUtLWFjdGl2ZScpO1xyXG4gIGJvZHkuY2xhc3NMaXN0LnRvZ2dsZSgnYm9keS0tYWN0aXZlLW1lbnUnKTtcclxufVxyXG5cclxuaGFtYnVyZ2VyLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJyAsIHRvZ2dsZU1lbnUpO1xyXG5cclxuXHJcbiIsImNvbnN0IHZhbGlkYXRlRmllbGRzID0gKGZvcm0sIGZpZWxkc0FycmF5KSA9PiB7XHJcblxyXG4gIGZpZWxkc0FycmF5LmZvckVhY2goZmllbGQgPT4ge1xyXG4gICAgZmllbGQucmVtb3ZlQ2xhc3MoXCJpbnB1dC1lcnJvclwiKTtcclxuICAgIGlmIChmaWVsZC52YWwoKS50cmltKCkgPT09IFwiXCIpIHtcclxuICAgICAgZmllbGQuYWRkQ2xhc3MoXCJpbnB1dC1lcnJvclwiKTtcclxuICAgIH1cclxuICB9KTtcclxuXHJcbiAgY29uc3QgZXJyb3JGaWVsZHMgPSBmb3JtLmZpbmQoXCIuaW5wdXQtZXJyb3JcIik7XHJcblxyXG4gIHJldHVybiBlcnJvckZpZWxkcy5sZW5ndGggPT09IDA7XHJcbn1cclxuXHJcbiQoJy5mb3JtJykuc3VibWl0KGUgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuXHJcbiAgY29uc3QgZm9ybSA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICBjb25zdCBuYW1lID0gZm9ybS5maW5kKFwiW25hbWU9J25hbWUnXVwiKTtcclxuICBjb25zdCBwaG9uZSA9IGZvcm0uZmluZChcIltuYW1lPSdwaG9uZSddXCIpO1xyXG4gIGNvbnN0IGNvbW1lbnQgPSBmb3JtLmZpbmQoXCJbbmFtZT0nY29tbWVudCddXCIpO1xyXG4gIGNvbnN0IHRvID0gZm9ybS5maW5kKFwiW25hbWU9J3RvJ11cIik7XHJcblxyXG4gIGNvbnN0IG1vZGFsID0gJChcIiNtb2RhbFwiKTtcclxuICBjb25zdCBjb250ZW50ID0gbW9kYWwuZmluZChcIi5tb2RhbF9fY29udGVudFwiKTtcclxuXHJcbiAgbW9kYWwucmVtb3ZlQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcclxuXHJcbiAgY29uc3QgaXNWYWxpZCA9IHZhbGlkYXRlRmllbGRzKGZvcm0sIFtuYW1lLCBwaG9uZSwgY29tbWVudCwgdG9dKTtcclxuXHJcbiAgaWYgKGlzVmFsaWQpIHtcclxuICAgIGNvbnN0IHJlcXVlc3QgPSAkLmFqYXgoe1xyXG4gICAgICB1cmw6IFwiaHR0cHM6Ly93ZWJkZXYtYXBpLmxvZnRzY2hvb2wuY29tL3NlbmRtYWlsXCIsXHJcbiAgICAgIG1ldGhvZDogXCJwb3N0XCIsXHJcbiAgICAgIGRhdGE6IHtcclxuICAgICAgICBuYW1lOiBuYW1lLnZhbCgpLFxyXG4gICAgICAgIHBob25lOiBwaG9uZS52YWwoKSxcclxuICAgICAgICBjb21tZW50OiBjb21tZW50LnZhbCgpLFxyXG4gICAgICAgIHRvOiB0by52YWwoKSxcclxuICAgICAgfSxcclxuICAgIH0pOyBcclxuXHJcbiAgICByZXF1ZXN0LmRvbmUoKGRhdGEpID0+IHtcclxuICAgICAgY29udGVudC50ZXh0KGRhdGEubWVzc2FnZSk7XHJcbiAgICB9KTtcclxuXHJcbiAgICByZXF1ZXN0LmZhaWwoKGRhdGEpID0+IHtcclxuICAgICAgY29uc3QgbWVzc2FnZSA9IGRhdGE/LnJlc3BvbnNlSlNPTj8ubWVzc2FnZSA/PyAn0J/RgNC+0LjQt9C+0YjQu9CwINC+0YjQuNCx0LrQsCwg0L/QvtC/0YDQvtCx0YPQudGC0LUg0L/QvtC30LbQtSc7XHJcbiAgICAgIGNvbnRlbnQudGV4dChtZXNzYWdlKTtcclxuICAgICAgbW9kYWwuYWRkQ2xhc3MoXCJlcnJvci1tb2RhbFwiKTtcclxuICAgIH0pO1xyXG5cclxuICAgIHJlcXVlc3QuYWx3YXlzKCgpID0+IHtcclxuICAgICAgJC5mYW5jeWJveC5vcGVuKHtcclxuICAgICAgICBzcmM6IFwiI21vZGFsXCIsXHJcbiAgICAgICAgdHlwZTogXCJpbmxpbmVcIlxyXG4gICAgICB9KTtcclxuICAgIH0pO1xyXG4gIH1cclxufSk7XHJcbiAgXHJcblxyXG4kKFwiLmFwcC1zdWJtaXQtYnRuXCIpLmNsaWNrKChlKSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICAkLmZhbmN5Ym94LmNsb3NlKCk7XHJcbn0pOyIsImxldCB2aWRlbztcclxubGV0IGR1cmF0aW9uQ29udHJvbDtcclxubGV0IHNvdW5kQ29udHJvbDtcclxubGV0IGludGVydmFsSWQ7XHJcblxyXG5kb2N1bWVudC5hZGRFdmVudExpc3RlbmVyKCdET01Db250ZW50TG9hZGVkJywgZSA9PiB7XHJcbiAgdmlkZW8gPSBkb2N1bWVudC5nZXRFbGVtZW50QnlJZCgndmlkZW8nKTtcclxuXHJcbiAgdmlkZW8uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwbGF5U3RvcCk7XHJcblxyXG4gIGxldCBwbGF5QnV0dG9ucyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3JBbGwoJy5wbGF5Jyk7XHJcbiAgZm9yIChsZXQgaSA9IDA7IGkgPCBwbGF5QnV0dG9ucy5sZW5ndGg7IGkrKykge1xyXG4gICAgcGxheUJ1dHRvbnNbaV0uYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBwbGF5U3RvcCk7XHJcbiAgfVxyXG5cclxuICBsZXQgbWljQ29udHJvbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdtaWNMZXZlbCcpO1xyXG4gIG1pY0NvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzb3VuZE9mKTtcclxuXHJcbiAgZHVyYXRpb25Db250cm9sID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ2R1cmF0aW9uTGV2ZWwnKTtcclxuICBkdXJhdGlvbkNvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignbW91c2Vkb3duJywgc3RvcEludGVydmFsKTtcclxuICBkdXJhdGlvbkNvbnRyb2wuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBzZXRWaWRlb0R1cmF0aW9uKTtcclxuXHJcbiAgZHVyYXRpb25Db250cm9sLm1pbiA9IDA7XHJcbiAgZHVyYXRpb25Db250cm9sLnZhbHVlID0gMDtcclxuXHJcbiAgc291bmRDb250cm9sID0gZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoJ3ZvbHVtZUxldmVsJyk7XHJcbiAgc291bmRDb250cm9sLmFkZEV2ZW50TGlzdGVuZXIoJ2NsaWNrJywgY2hhbmdlU291bmRWb2x1bWUpO1xyXG4gIHNvdW5kQ29udHJvbC5hZGRFdmVudExpc3RlbmVyKCdtb3VzZXVwJywgY2hhbmdlU291bmRWb2x1bWUpO1xyXG5cclxuICBzb3VuZENvbnRyb2wubWluID0gMDtcclxuICBzb3VuZENvbnRyb2wubWF4ID0gMTA7XHJcblxyXG4gIHNvdW5kQ29udHJvbC52YWx1ZSA9IHNvdW5kQ29udHJvbC5tYXg7XHJcbn0pXHJcblxyXG5mdW5jdGlvbiBwbGF5U3RvcCgpIHtcclxuICBsZXQgcGxheUltZyA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy52aWRlb19fcGxheScpO1xyXG4gIHBsYXlJbWcuY2xhc3NMaXN0LnRvZ2dsZSgndmlkZW9fX3BsYXktLWFjdGl2ZScpO1xyXG5cclxuICBkdXJhdGlvbkNvbnRyb2wubWF4ID0gdmlkZW8uZHVyYXRpb247XHJcblxyXG4gIGlmKHZpZGVvLnBhdXNlZCkge1xyXG4gICAgdmlkZW8ucGxheSgpO1xyXG4gICAgaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKHVwZGF0ZUR1cmF0aW9uLCAxMDAwIC82Nik7XHJcbiAgfSBlbHNle1xyXG4gICAgdmlkZW8ucGF1c2UoKTtcclxuICAgIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XHJcbiAgfVxyXG59XHJcblxyXG5mdW5jdGlvbiB1cGRhdGVEdXJhdGlvbigpIHtcclxuICBkdXJhdGlvbkNvbnRyb2wudmFsdWUgPSB2aWRlby5jdXJyZW50VGltZTtcclxufVxyXG5cclxuZnVuY3Rpb24gc3RvcEludGVydmFsICgpIHtcclxuICB2aWRlby5wYXVzZSgpO1xyXG4gIGNsZWFySW50ZXJ2YWwoaW50ZXJ2YWxJZCk7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIHNldFZpZGVvRHVyYXRpb24gKCkge1xyXG4gIGlmKHZpZGVvLnBhdXNlZCkge1xyXG4gICAgdmlkZW8ucGxheSgpO1xyXG4gIH0gZWxzZSB7XHJcbiAgICB2aWRlby5wYXVzZSgpO1xyXG4gIH1cclxuXHJcbiAgdmlkZW8uY3VycmVudFRpbWUgPSBkdXJhdGlvbkNvbnRyb2wudmFsdWU7XHJcbiAgaW50ZXJ2YWxJZCA9IHNldEludGVydmFsKHVwZGF0ZUR1cmF0aW9uLCAxMDAwIC82Nik7XHJcbn1cclxuXHJcbmZ1bmN0aW9uIGNoYW5nZVNvdW5kVm9sdW1lKCkge1xyXG4gIHZpZGVvLnZvbHVtZSA9IHNvdW5kQ29udHJvbCAvIDEwO1xyXG59XHJcblxyXG5mdW5jdGlvbiBzb3VuZE9mKCkge1xyXG4gIGlmKHZpZGVvLnZvbHVtZSA9PT0gMCl7XHJcbiAgICB2aWRlby52b2x1bWUgPSBzb3VuZExldmVsO1xyXG4gICAgc291bmRDb250cm9sLnZhbHVlID0gc291bmRMZXZlbCAqIDEwO1xyXG4gIH0gZWxzZXtcclxuICAgIHNvdW5kTGV2ZWwgPSB2aWRlby52b2x1bWU7XHJcbiAgICB2aWRlby52b2x1bWUgPSAwO1xyXG4gICAgc291bmRDb250cm9sLnZhbHVlID0gMDtcclxuICB9XHJcbn0iLCJjb25zdCBmaW5kQmxvY2tCeUFsaWFzID0gYWxpYXMgPT4ge1xyXG4gIHJldHVybiAkKFwiLnJldmlld3NfX2l0ZW1cIikuZmlsdGVyKChuZHgsIGl0ZW0pID0+IHtcclxuICAgIHJldHVybiAkKGl0ZW0pLmF0dHIoXCJkYXRhLWxpbmtlZC13aXRoXCIpID09PSBhbGlhcztcclxuICB9KVxyXG59XHJcblxyXG4kKFwiLnJldmlld3Mtc3dpdGNoZXJfX2xpbmtcIikuY2xpY2soZSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1vcGVuXCIpO1xyXG4gIGNvbnN0IGl0ZW1Ub1Nob3cgPSBmaW5kQmxvY2tCeUFsaWFzKHRhcmdldCk7XHJcbiAgY29uc3QgY3VySXRlbSA9ICR0aGlzLmNsb3Nlc3QoXCIucmV2aWV3cy1zd2l0Y2hlcl9faXRlbVwiKTtcclxuXHJcbiAgaXRlbVRvU2hvdy5hZGRDbGFzcyhcImFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG4gIGN1ckl0ZW0uYWRkQ2xhc3MoXCJhY3RpdmVcIikuc2libGluZ3MoKS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxufSk7IiwiY29uc3Qgc2VjdGlvbnMgPSAkKFwic2VjdGlvblwiKTtcclxuY29uc3QgZGlzcGxheSA9ICQoXCIud3JhcHBlcl9fY29udGVudFwiKTtcclxuY29uc3Qgc2lkZU1lbnUgPSAkKFwiLmZpeGVkLW1lbnVcIik7XHJcbmNvbnN0IG1lbnVJdGVtcyA9IHNpZGVNZW51LmZpbmQoXCIuZml4ZWQtbWVudV9faXRlbVwiKTtcclxuXHJcbmNvbnN0IG1vYmlsZURldGVjdCA9IG5ldyBNb2JpbGVEZXRlY3Qod2luZG93Lm5hdmlnYXRvci51c2VyQWdlbnQpO1xyXG5jb25zdCBpc01vYmlsZSA9IG1vYmlsZURldGVjdC5tb2JpbGUoKTtcclxuXHJcbmxldCBpblNjcm9sbCA9IGZhbHNlO1xyXG5cclxuc2VjdGlvbnMuZmlyc3QoKS5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuXHJcbmNvbnN0IGNvdW50U2VjdGlvblBvc2l0aW9uID0gKHNlY3Rpb25FcSkgPT4ge1xyXG4gIGNvbnN0IHBvc2l0aW9uID0gc2VjdGlvbkVxICogLTEwMDtcclxuXHJcbiAgaWYoaXNOYU4ocG9zaXRpb24pKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwi0L/QtdGA0LXQtNCw0L3QviDQvdC10LLQtdGA0L3QvtC1INC30L3QsNGH0LXQvdC40LUg0LIgIGNvdW50U2VjdGlvblBvc2l0aW9uXCIpO1xyXG4gICAgcmV0dXJuIDA7XHJcbiAgfVxyXG5cclxuICByZXR1cm4gcG9zaXRpb247XHJcbn1cclxuXHJcbmNvbnN0IGNoYW5nZU1lbnVUaGVtZUZvclNlY3Rpb24gPSAoc2VjdGlvbkVxKSA9PiB7XHJcbiAgY29uc3QgY3VycmVudFNlY3Rpb24gPSBzZWN0aW9ucy5lcShzZWN0aW9uRXEpO1xyXG4gIGNvbnN0IG1lbnVUaGVtZSA9IGN1cnJlbnRTZWN0aW9uLmF0dHIoXCJkYXRhLXNpZGVtZW51LXRoZW1lXCIpO1xyXG4gIGNvbnN0IGFjdGl2ZUNsYXNzID0gXCJmaXhlZC1tZW51LS1zaGFkb3dlZFwiO1xyXG4gIFxyXG4gIGlmKG1lbnVUaGVtZSA9PT0gXCJ3aGl0ZVwiKSB7XHJcbiAgICBzaWRlTWVudS5hZGRDbGFzcyhhY3RpdmVDbGFzcyk7XHJcbiAgfSBlbHNlIHtcclxuICAgIHNpZGVNZW51LnJlbW92ZUNsYXNzKGFjdGl2ZUNsYXNzKTtcclxuICB9XHJcbn07XHJcblxyXG5jb25zdCByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbSA9IChpdGVtcywgaXRlbUVxLCBhY3RpdmVDbGFzcykgPT4ge1xyXG4gIGl0ZW1zLmVxKGl0ZW1FcSkuYWRkQ2xhc3MoYWN0aXZlQ2xhc3MpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoYWN0aXZlQ2xhc3MpO1xyXG59XHJcblxyXG5jb25zdCBwZXJmb3JtVHJhbnNpdGlvbiA9IChzZWN0aW9uRXEpID0+IHtcclxuICBpZihpblNjcm9sbCkgcmV0dXJuO1xyXG5cclxuICBjb25zdCB0cmFuc2l0aW9uT3ZlciA9IDEwMDA7XHJcbiAgY29uc3QgbW91c2VJbmVydGlhT3ZlciA9IDMwMDtcclxuXHJcbiAgaW5TY3JvbGwgPSB0cnVlO1xyXG5cclxuICAgIGNvbnN0IHBvc2l0aW9uID0gY291bnRTZWN0aW9uUG9zaXRpb24oc2VjdGlvbkVxKTtcclxuXHJcbiAgICBjaGFuZ2VNZW51VGhlbWVGb3JTZWN0aW9uKHNlY3Rpb25FcSk7XHJcblxyXG4gICAgZGlzcGxheS5jc3Moe1xyXG4gICAgICB0cmFuc2Zvcm06IGB0cmFuc2xhdGVZKCR7cG9zaXRpb259JSlgLFxyXG4gICAgfSk7XHJcblxyXG4gICAgcmVzZXRBY3RpdmVDbGFzc0Zvckl0ZW0oc2VjdGlvbnMsIHNlY3Rpb25FcSwgXCJhY3RpdmVcIik7XHJcblxyXG4gICAgLy9zZWN0aW9ucy5lcShzZWN0aW9uRXEpLmFkZENsYXNzKFwiYWN0aXZlXCIpLnNpYmxpbmdzKCkucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcblxyXG4gICAgLy9zaWRlTWVudS5maW5kKFwiLmZpeGVkLW1lbnVfX2l0ZW1cIikuZXEoc2VjdGlvbkVxKS5hZGRDbGFzcyhcImFjdGl2ZVwiKS5zaWJsaW5ncygpLnJlbW92ZUNsYXNzKFwiYWN0aXZlXCIpO1xyXG5cclxuICAgIHNldFRpbWVvdXQoKCkgPT4ge1xyXG4gICAgICBpblNjcm9sbCA9IGZhbHNlO1xyXG4gICAgICByZXNldEFjdGl2ZUNsYXNzRm9ySXRlbShtZW51SXRlbXMsIHNlY3Rpb25FcSwgXCJmaXhlZC1tZW51X19pdGVtLS1hY3RpdmVcIik7XHJcbiAgICB9LCB0cmFuc2l0aW9uT3ZlciArIG1vdXNlSW5lcnRpYU92ZXIpO1xyXG4gIFxyXG59O1xyXG5cclxuY29uc3Qgdmlld3BvcnRTY3JvbGxlciA9ICgpID0+IHsgXHJcbiAgY29uc3QgYWN0aXZlU2VjdGlvbiA9IHNlY3Rpb25zLmZpbHRlcihcIi5hY3RpdmVcIik7XHJcbiAgY29uc3QgbmV4dFNlY3Rpb24gPSBhY3RpdmVTZWN0aW9uLm5leHQoKTtcclxuICBjb25zdCBwcmV2U2VjdGlvbiA9IGFjdGl2ZVNlY3Rpb24ucHJldigpO1xyXG5cclxuICByZXR1cm4ge1xyXG4gICAgbmV4dCgpIHtcclxuICAgICAgaWYobmV4dFNlY3Rpb24ubGVuZ3RoKSB7XHJcbiAgICAgICAgcGVyZm9ybVRyYW5zaXRpb24obmV4dFNlY3Rpb24uaW5kZXgoKSk7XHJcbiAgICAgIH1cclxuICAgIH0sXHJcbiAgICBwcmV2KCkge1xyXG4gICAgICBpZihwcmV2U2VjdGlvbi5sZW5ndGgpIHtcclxuICAgICAgICBwZXJmb3JtVHJhbnNpdGlvbihwcmV2U2VjdGlvbi5pbmRleCgpKTtcclxuICAgICAgfVxyXG4gICAgfSxcclxuICB9O1xyXG59O1xyXG5cclxuJCh3aW5kb3cpLm9uKFwid2hlZWxcIiwgZSA9PiB7XHJcbiAgY29uc3QgZGVsdGFZID0gZS5vcmlnaW5hbEV2ZW50LmRlbHRhWTtcclxuICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuXHJcbiAgaWYgKGRlbHRhWSA+MCkge1xyXG4gICAgc2Nyb2xsZXIubmV4dCgpO1xyXG4gIH1cclxuXHJcbiAgaWYgKGRlbHRhWSA8MCkge1xyXG4gICAgc2Nyb2xsZXIucHJldigpO1xyXG4gIH1cclxufSk7XHJcblxyXG4kKHdpbmRvdykub24oXCJrZXlkb3duXCIsIGUgPT4ge1xyXG4gIGNvbnN0IHRhZ05hbWUgPSBlLnRhcmdldC50YWdOYW1lLnRvTG93ZXJDYXNlKCk7XHJcbiAgY29uc3QgdXNlclR5cGluZ0luSW5wdXRzID0gdGFnTmFtZSA9PT0gXCJpbnB1dFwiIHx8IHRhZ05hbWUgPT09IFwidGV4dGFyZWFcIjtcclxuICBjb25zdCBzY3JvbGxlciA9IHZpZXdwb3J0U2Nyb2xsZXIoKTtcclxuXHJcbiAgaWYgKHVzZXJUeXBpbmdJbklucHV0cykgcmV0dXJuOyBcclxuICAgIHN3aXRjaCAoZS5jb2RlKSB7XHJcbiAgICAgIGNhc2UgMzg6XHJcbiAgICAgICAgc2Nyb2xsZXIucHJldigpO1xyXG4gICAgICAgIGJyZWFrO1xyXG4gIFxyXG4gICAgICBjYXNlIDQwOlxyXG4gICAgICAgIHNjcm9sbGVyLm5leHQoKTtcclxuICAgICAgICBicmVhaztcclxuICAgIH1cclxufSk7XHJcblxyXG4kKFwiLndyYXBwZXJcIikub24oXCJ0b3VjaG1vdmVcIiwgZSA9PiBlLnByZXZlbnREZWZhdWx0KCkpO1xyXG5cclxuJChcIltkYXRhLXNjcm9sbC10b11cIikuY2xpY2soZSA9PiB7XHJcbiAgZS5wcmV2ZW50RGVmYXVsdCgpO1xyXG5cclxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICBjb25zdCB0YXJnZXQgPSAkdGhpcy5hdHRyKFwiZGF0YS1zY3JvbGwtdG9cIik7XHJcbiAgY29uc3QgcmVxU2VjdGlvbiA9ICQoYFtkYXRhLXNlY3Rpb24taWQ9JHt0YXJnZXR9XWApO1xyXG5cclxuICBwZXJmb3JtVHJhbnNpdGlvbihyZXFTZWN0aW9uLmluZGV4KCkpO1xyXG59KTtcclxuXHJcbmlmIChpc01vYmlsZSkge1xyXG4gIC8vaHR0cHM6Ly9naXRodWIuY29tL21hdHRicnlzb24vVG91Y2hTd2lwZS1KcXVlcnktUGx1Z2luXHJcbiAgJChcImJvZHlcIikuc3dpcGUoe1xyXG4gICAgc3dpcGU6IGZ1bmN0aW9uKGV2ZW50LCBkaXJlY3Rpb24pIHtcclxuICAgICAgY29uc3Qgc2Nyb2xsZXIgPSB2aWV3cG9ydFNjcm9sbGVyKCk7XHJcbiAgICAgIGxldCBzY3JvbGxEaXJlY3Rpb24gPSBcIlwiO1xyXG5cclxuICAgICAgaWYoZGlyZWN0aW9uID09PSBcInVwXCIpIHNjcm9sbERpcmVjdGlvbiA9IFwibmV4dFwiO1xyXG4gICAgICBpZihkaXJlY3Rpb24gPT09IFwiZG93blwiKSBzY3JvbGxEaXJlY3Rpb24gPSBcInByZXZcIjtcclxuXHJcbiAgICAgIHNjcm9sbGVyW3Njcm9sbERpcmVjdGlvbl0oKTtcclxuICAgIH0sXHJcbiAgfSk7XHJcbn1cclxuXHJcbiIsImNvbnN0IHNsaWRlciA9ICQoXCIuc2xpZGVyX19saXN0XCIpLmJ4U2xpZGVyKHtcclxuICBwYWdlcjogZmFsc2UsXHJcbiAgY29udHJvbHM6IGZhbHNlXHJcbn0pO1xyXG5cclxuJCgnLnNsaWRlcl9fYXJyb3ctLWxlZnQnKS5jbGljayhlID0+IHtcclxuICBlLnByZXZlbnREZWZhdWx0KCk7XHJcbiAgc2xpZGVyLmdvVG9QcmV2U2xpZGUoKTtcclxufSlcclxuXHJcbiQoJy5zbGlkZXJfX2Fycm93LS1yaWdodCcpLmNsaWNrKGUgPT4ge1xyXG4gIGUucHJldmVudERlZmF1bHQoKTtcclxuICBzbGlkZXIuZ29Ub05leHRTbGlkZSgpO1xyXG59KSIsImNvbnN0IG9wZW5JdGVtID0gaXRlbSA9PiB7XHJcbiAgY29uc3QgY29udGFpbmVyID0gaXRlbS5jbG9zZXN0KFwiLnRlYW1fX2l0ZW1cIik7XHJcbiAgY29uc3QgY29udGVudEJsb2NrID0gY29udGFpbmVyLmZpbmQoXCIudGVhbV9fY29udGVudFwiKTtcclxuICBjb25zdCB0ZXh0QmxvY2sgPSBjb250ZW50QmxvY2suZmluZChcIi50ZWFtX19jb250ZW50LWJsb2NrXCIpO1xyXG4gIGNvbnN0IHJlcUhlaWdodCA9IHRleHRCbG9jay5oZWlnaHQoKTtcclxuICBjb25zdCByZWN0YW5nbGVQb3NpdGlvbiA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2Ryb3Bkb3duLWljb25cIik7XHJcblxyXG4gIGNvbnRhaW5lci5hZGRDbGFzcyhcImFjdGl2ZVwiKTtcclxuICBjb250ZW50QmxvY2suaGVpZ2h0KHJlcUhlaWdodCk7XHJcbiAgcmVjdGFuZ2xlUG9zaXRpb24uYWRkQ2xhc3MoXCJhY3RpdmVcIik7XHJcbn1cclxuXHJcbmNvbnN0IGNsb3NlRXZlcnlJdGVtID0gY29udGFpbmVyID0+IHtcclxuICBjb25zdCBpdGVtcyA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2NvbnRlbnRcIik7XHJcbiAgY29uc3QgaXRlbUNvbnRhaW5lciA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2l0ZW1cIik7XHJcbiAgY29uc3QgaXRlbVJlY3RhbmdsZSA9IGNvbnRhaW5lci5maW5kKFwiLnRlYW1fX2Ryb3Bkb3duLWljb25cIik7XHJcblxyXG4gIGl0ZW1Db250YWluZXIucmVtb3ZlQ2xhc3MoXCJhY3RpdmVcIik7XHJcbiAgaXRlbVJlY3RhbmdsZS5yZW1vdmVDbGFzcyhcImFjdGl2ZVwiKTtcclxuICBpdGVtcy5oZWlnaHQoMCk7XHJcbn0gXHJcblxyXG4kKCcudGVhbV9fZHJvcGRvd24nKS5jbGljayhlID0+IHtcclxuICBjb25zdCAkdGhpcyA9ICQoZS5jdXJyZW50VGFyZ2V0KTtcclxuICBjb25zdCBjb250YWluZXIgPSAkdGhpcy5jbG9zZXN0KFwiLnRlYW1cIik7XHJcbiAgY29uc3QgZWxlbUNvbnRhaW5lciA9ICR0aGlzLmNsb3Nlc3QoXCIudGVhbV9faXRlbVwiKTtcclxuXHJcbiAgaWYgKGVsZW1Db250YWluZXIuaGFzQ2xhc3MoXCJhY3RpdmVcIikpIHtcclxuICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XHJcbiAgfSBlbHNlIHtcclxuICAgIGNsb3NlRXZlcnlJdGVtKGNvbnRhaW5lcik7XHJcbiAgICBvcGVuSXRlbSgkdGhpcyk7XHJcbiAgfVxyXG59KVxyXG4iXX0=
